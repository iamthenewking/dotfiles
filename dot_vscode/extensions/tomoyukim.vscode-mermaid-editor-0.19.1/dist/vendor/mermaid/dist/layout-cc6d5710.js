import{a6 as isObjectLike,a7 as baseGetTag,a8 as Symbol$1,a9 as isArray,aa as isObject,ab as getNative,ac as eq,ad as isArrayLike,ae as isArguments,af as isBuffer,ag as isTypedArray,ah as baseKeys,ai as isPrototype,aj as memoize,ak as overArg,al as ListCache,am as Map,an as MapCache,ao as root,ap as getTag,aq as nodeUtil,ar as baseUnary,as as isLength,y as isFunction,at as Set,au as isEmpty}from"./mermaid-766fee4c.js";var symbolTag$3="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag$3}function arrayMap(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var INFINITY$3=1/0,symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$3?"-0":t}var reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var reTrimStart=/^\s+/;function baseTrim(e){return e?e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,""):e}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber(e))===INFINITY$2||e===-INFINITY$2?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var t=toFinite(e),r=t%1;return t==t?r?t-r:t:0}function identity(e){return e}var objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();const baseCreate$1=baseCreate;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function noop(){}function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var n=nativeNow(),a=HOT_SPAN-(n-r);if(r=n,a>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(e,t){return defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;function arrayEach(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function baseFindIndex(e,t,r,n){for(var a=e.length,o=r+(n?1:-1);n?o--:++o<a;)if(t(e[o],o,e))return o;return-1}function baseIsNaN(e){return e!=e}function strictIndexOf(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}function baseIndexOf(e,t,r){return t==t?strictIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r)}function arrayIncludes(e,t){return!(null==e||!e.length)&&baseIndexOf(e,t,0)>-1}var MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}function baseAssignValue(e,t,r){"__proto__"==t&&defineProperty$1?defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$8.call(e,t)&&eq(n,r)&&(void 0!==r||t in e)||baseAssignValue(e,t,r)}function copyObject(e,t,r,n){var a=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var s=t[o],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),a?baseAssignValue(r,s,u):assignValue(r,s,u)}return r}var nativeMax$2=Math.max;function overRest(e,t,r){return t=nativeMax$2(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,o=nativeMax$2(n.length-t,0),i=Array(o);++a<o;)i[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(i),apply(e,this,s)}}function baseRest(e,t){return setToString$1(overRest(e,t,identity),e+"")}function isIterateeCall(e,t,r){if(!isObject(r))return!1;var n=typeof t;return!!("number"==n?isArrayLike(r)&&isIndex(t,r.length):"string"==n&&t in r)&&eq(r[t],e)}function createAssigner(e){return baseRest((function(t,r){var n=-1,a=r.length,o=a>1?r[a-1]:void 0,i=a>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,i&&isIterateeCall(r[0],r[1],i)&&(o=a<3?void 0:o,a=1),t=Object(t);++n<a;){var s=r[n];s&&e(t,s,n,o)}return t}))}function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray(e),n=!r&&isArguments(e),a=!r&&!n&&isBuffer(e),o=!r&&!n&&!a&&isTypedArray(e),i=r||n||a||o,s=i?baseTimes(e.length,String):[],u=s.length;for(var c in e)!t&&!hasOwnProperty$7.call(e,c)||i&&("length"==c||a&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex(c,u))||s.push(c);return s}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function baseKeysIn(e){if(!isObject(e))return nativeKeysIn(e);var t=isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$6.call(e,n))&&r.push(n);return r}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t)}var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize(e,(function(e){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),e})),r=t.cache;return t}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,r,n,a){t.push(n?a.replace(reEscapeChar,"$1"):r||e)})),t}));const stringToPath$1=stringToPath;function toString(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray(e)?e:isKey(e,t)?[e]:stringToPath$1(toString(e))}var INFINITY$1=1/0;function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}function baseGet(e,t){for(var r=0,n=(t=castPath(t,e)).length;null!=e&&r<n;)e=e[toKey(t[r++])];return r&&r==n?e:void 0}function get(e,t,r){var n=null==e?void 0:baseGet(e,t);return void 0===n?r:n}function arrayPush(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,r,n,a){var o=-1,i=e.length;for(r||(r=isFlattenable),a||(a=[]);++o<i;){var s=e[o];t>0&&r(s)?t>1?baseFlatten(s,t-1,r,n,a):arrayPush(a,s):n||(a[a.length]=s)}return a}function flatten(e){return null!=e&&e.length?baseFlatten(e,1):[]}function flatRest(e){return setToString$1(overRest(e,void 0,flatten),e+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;var objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$6=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$5=objectProto$6.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(e){if(!isObjectLike(e)||baseGetTag(e)!=objectTag$2)return!1;var t=getPrototype$1(e);if(null===t)return!0;var r=hasOwnProperty$5.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}function arrayReduce(e,t,r,n){var a=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++a]);++a<o;)r=t(r,e[a],a,e);return r}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$1=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map||n.length<LARGE_ARRAY_SIZE$1-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(e,t),this.size=r.size,this}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}function baseAssignIn(e,t){return e&&copyObject(t,keysIn(t),e)}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(e,t){if(t)return e.slice();var r=e.length,n=allocUnsafe?allocUnsafe(r):new e.constructor(r);return e.copy(n),n}function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o}function stubArray(){return[]}var objectProto$5=Object.prototype,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),(function(t){return propertyIsEnumerable.call(e,t)})))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(e,t){return copyObject(e,getSymbols$1(e),t)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush(t,getSymbols$1(e)),e=getPrototype$1(e);return t}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(e,t){return copyObject(e,getSymbolsIn$1(e),t)}function baseGetAllKeys(e,t,r){var n=t(e);return isArray(e)?n:arrayPush(n,r(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols$1)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn,getSymbolsIn$1)}var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$4.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Uint8Array=root.Uint8Array;const Uint8Array$1=Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array$1(t).set(new Uint8Array$1(e)),t}function cloneDataView(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}function cloneTypedArray(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$2:return cloneArrayBuffer(e);case boolTag$2:case dateTag$2:return new n(+e);case dataViewTag$2:return cloneDataView(e,r);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,r);case mapTag$3:return new n;case numberTag$2:case stringTag$2:return new n(e);case regexpTag$2:return cloneRegExp(e);case setTag$3:return new n;case symbolTag$2:return cloneSymbol(e)}}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate$1(getPrototype$1(e))}var mapTag$2="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag(e)==mapTag$2}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag(e)==setTag$2}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(e,t,r,n,a,o){var i,s=t&CLONE_DEEP_FLAG$1,u=t&CLONE_FLAT_FLAG,c=t&CLONE_SYMBOLS_FLAG$1;if(r&&(i=a?r(e,n,a,o):r(e)),void 0!==i)return i;if(!isObject(e))return e;var f=isArray(e);if(f){if(i=initCloneArray(e),!s)return copyArray(e,i)}else{var d=getTag(e),l=d==funcTag||d==genTag;if(isBuffer(e))return cloneBuffer(e,s);if(d==objectTag$1||d==argsTag$1||l&&!a){if(i=u||l?{}:initCloneObject(e),!s)return u?copySymbolsIn(e,baseAssignIn(i,e)):copySymbols(e,baseAssign(i,e))}else{if(!cloneableTags[d])return a?e:{};i=initCloneByTag(e,d,s)}}o||(o=new Stack);var h=o.get(e);if(h)return h;o.set(e,i),isSet$1(e)?e.forEach((function(n){i.add(baseClone(n,t,r,n,e,o))})):isMap$1(e)&&e.forEach((function(n,a){i.set(a,baseClone(n,t,r,a,e,o))}));var g=f?void 0:(c?u?getAllKeysIn:getAllKeys:u?keysIn:keys)(e);return arrayEach(g||e,(function(n,a){g&&(n=e[a=n]),assignValue(i,a,baseClone(n,t,r,a,e,o))})),i}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}function arraySome(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,t,r,n,a,o){var i=r&COMPARE_PARTIAL_FLAG$5,s=e.length,u=t.length;if(s!=u&&!(i&&u>s))return!1;var c=o.get(e),f=o.get(t);if(c&&f)return c==t&&f==e;var d=-1,l=!0,h=r&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var g=e[d],b=t[d];if(n)var p=i?n(b,g,d,t,e,o):n(g,b,d,e,t,o);if(void 0!==p){if(p)continue;l=!1;break}if(h){if(!arraySome(t,(function(e,t){if(!cacheHas(h,t)&&(g===e||a(g,e,r,n,o)))return h.push(t)}))){l=!1;break}}else if(g!==b&&!a(g,b,r,n,o)){l=!1;break}}return o.delete(e),o.delete(t),l}function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function setToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,r,n,a,o,i){switch(r){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag:return!(e.byteLength!=t.byteLength||!o(new Uint8Array$1(e),new Uint8Array$1(t)));case boolTag:case dateTag:case numberTag:return eq(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag:case stringTag:return e==t+"";case mapTag:var s=mapToArray;case setTag:var u=n&COMPARE_PARTIAL_FLAG$4;if(s||(s=setToArray),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;n|=COMPARE_UNORDERED_FLAG$2,i.set(e,t);var f=equalArrays(s(e),s(t),n,a,o,i);return i.delete(e),f;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function equalObjects(e,t,r,n,a,o){var i=r&COMPARE_PARTIAL_FLAG$3,s=getAllKeys(e),u=s.length;if(u!=getAllKeys(t).length&&!i)return!1;for(var c=u;c--;){var f=s[c];if(!(i?f in t:hasOwnProperty$3.call(t,f)))return!1}var d=o.get(e),l=o.get(t);if(d&&l)return d==t&&l==e;var h=!0;o.set(e,t),o.set(t,e);for(var g=i;++c<u;){var b=e[f=s[c]],p=t[f];if(n)var v=i?n(p,b,f,t,e,o):n(b,p,f,e,t,o);if(!(void 0===v?b===p||a(b,p,r,n,o):v)){h=!1;break}g||(g="constructor"==f)}if(h&&!g){var y=e.constructor,m=t.constructor;y==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m||(h=!1)}return o.delete(e),o.delete(t),h}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function baseIsEqualDeep(e,t,r,n,a,o){var i=isArray(e),s=isArray(t),u=i?arrayTag:getTag(e),c=s?arrayTag:getTag(t),f=(u=u==argsTag?objectTag:u)==objectTag,d=(c=c==argsTag?objectTag:c)==objectTag,l=u==c;if(l&&isBuffer(e)){if(!isBuffer(t))return!1;i=!0,f=!1}if(l&&!f)return o||(o=new Stack),i||isTypedArray(e)?equalArrays(e,t,r,n,a,o):equalByTag(e,t,u,r,n,a,o);if(!(r&COMPARE_PARTIAL_FLAG$2)){var h=f&&hasOwnProperty$2.call(e,"__wrapped__"),g=d&&hasOwnProperty$2.call(t,"__wrapped__");if(h||g){var b=h?e.value():e,p=g?t.value():t;return o||(o=new Stack),a(b,p,r,n,o)}}return!!l&&(o||(o=new Stack),equalObjects(e,t,r,n,a,o))}function baseIsEqual(e,t,r,n,a){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,n,baseIsEqual,a))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,t,r,n){var a=r.length,o=a,i=!n;if(null==e)return!o;for(e=Object(e);a--;){var s=r[a];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<o;){var u=(s=r[a])[0],c=e[u],f=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var d=new Stack;if(n)var l=n(c,f,u,e,t,d);if(!(void 0===l?baseIsEqual(f,c,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,d):l))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject(e)}function getMatchData(e){for(var t=keys(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,isStrictComparable(a)]}return t}function matchesStrictComparable(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}function baseMatches(e){var t=getMatchData(e);return 1==t.length&&t[0][2]?matchesStrictComparable(t[0][0],t[0][1]):function(r){return r===e||baseIsMatch(r,e,t)}}function baseHasIn(e,t){return null!=e&&t in Object(e)}function hasPath(e,t,r){for(var n=-1,a=(t=castPath(t,e)).length,o=!1;++n<a;){var i=toKey(t[n]);if(!(o=null!=e&&r(e,i)))break;e=e[i]}return o||++n!=a?o:!!(a=null==e?0:e.length)&&isLength(a)&&isIndex(i,a)&&(isArray(e)||isArguments(e))}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(e,t){return isKey(e)&&isStrictComparable(t)?matchesStrictComparable(toKey(e),t):function(r){var n=get(r,e);return void 0===n&&n===t?hasIn(r,e):baseIsEqual(t,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function basePropertyDeep(e){return function(t){return baseGet(t,e)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?isArray(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function createBaseFor(e){return function(t,r,n){for(var a=-1,o=Object(t),i=n(t),s=i.length;s--;){var u=i[e?s:++a];if(!1===r(o[u],u,o))break}return t}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(e,t){return e&&baseFor$1(e,t,keys)}function createBaseEach(e,t){return function(r,n){if(null==r)return r;if(!isArrayLike(r))return e(r,n);for(var a=r.length,o=t?a:-1,i=Object(r);(t?o--:++o<a)&&!1!==n(i[o],o,i););return r}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;var now=function(){return root.Date.now()};const now$1=now;var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty,defaults=baseRest((function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&isIterateeCall(t[0],t[1],a)&&(n=1);++r<n;)for(var o=t[r],i=keysIn(o),s=-1,u=i.length;++s<u;){var c=i[s],f=e[c];(void 0===f||eq(f,objectProto$1[c])&&!hasOwnProperty$1.call(e,c))&&(e[c]=o[c])}return e}));const defaults$1=defaults;function assignMergeValue(e,t,r){(void 0!==r&&!eq(e[t],r)||void 0===r&&!(t in e))&&baseAssignValue(e,t,r)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function toPlainObject(e){return copyObject(e,keysIn(e))}function baseMergeDeep(e,t,r,n,a,o,i){var s=safeGet(e,r),u=safeGet(t,r),c=i.get(u);if(c)assignMergeValue(e,r,c);else{var f=o?o(s,u,r+"",e,t,i):void 0,d=void 0===f;if(d){var l=isArray(u),h=!l&&isBuffer(u),g=!l&&!h&&isTypedArray(u);f=u,l||h||g?isArray(s)?f=s:isArrayLikeObject(s)?f=copyArray(s):h?(d=!1,f=cloneBuffer(u,!0)):g?(d=!1,f=cloneTypedArray(u,!0)):f=[]:isPlainObject(u)||isArguments(u)?(f=s,isArguments(s)?f=toPlainObject(s):isObject(s)&&!isFunction(s)||(f=initCloneObject(u))):d=!1}d&&(i.set(u,f),a(f,u,n,o,i),i.delete(u)),assignMergeValue(e,r,f)}}function baseMerge(e,t,r,n,a){e!==t&&baseFor$1(t,(function(o,i){if(a||(a=new Stack),isObject(o))baseMergeDeep(e,t,i,r,baseMerge,n,a);else{var s=n?n(safeGet(e,i),o,i+"",e,t,a):void 0;void 0===s&&(s=o),assignMergeValue(e,i,s)}}),keysIn)}function arrayIncludesWith(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function castFunction(e){return"function"==typeof e?e:identity}function forEach(e,t){return(isArray(e)?arrayEach:baseEach$1)(e,castFunction(t))}function baseFilter(e,t){var r=[];return baseEach$1(e,(function(e,n,a){t(e,n,a)&&r.push(e)})),r}function filter(e,t){return(isArray(e)?arrayFilter:baseFilter)(e,baseIteratee(t))}function createFind(e){return function(t,r,n){var a=Object(t);if(!isArrayLike(t)){var o=baseIteratee(r);t=keys(t),r=function(e){return o(a[e],e,a)}}var i=e(t,r,n);return i>-1?a[o?t[i]:i]:void 0}}var nativeMax$1=Math.max;function findIndex(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=null==r?0:toInteger(r);return a<0&&(a=nativeMax$1(n+a,0)),baseFindIndex(e,baseIteratee(t),a)}var find=createFind(findIndex);const find$1=find;function baseMap(e,t){var r=-1,n=isArrayLike(e)?Array(e.length):[];return baseEach$1(e,(function(e,a,o){n[++r]=t(e,a,o)})),n}function map(e,t){return(isArray(e)?arrayMap:baseMap)(e,baseIteratee(t))}function forIn(e,t){return null==e?e:baseFor$1(e,castFunction(t),keysIn)}function forOwn(e,t){return e&&baseForOwn(e,castFunction(t))}function baseGt(e,t){return e>t}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function baseHas(e,t){return null!=e&&hasOwnProperty.call(e,t)}function has(e,t){return null!=e&&hasPath(e,t,baseHas)}function baseValues(e,t){return arrayMap(t,(function(t){return e[t]}))}function values(e){return null==e?[]:baseValues(e,keys(e))}function isUndefined(e){return void 0===e}function baseLt(e,t){return e<t}function mapValues(e,t){var r={};return t=baseIteratee(t),baseForOwn(e,(function(e,n,a){baseAssignValue(r,n,t(e,n,a))})),r}function baseExtremum(e,t,r){for(var n=-1,a=e.length;++n<a;){var o=e[n],i=t(o);if(null!=i&&(void 0===s?i==i&&!isSymbol(i):r(i,s)))var s=i,u=o}return u}function max(e){return e&&e.length?baseExtremum(e,identity,baseGt):void 0}var merge=createAssigner((function(e,t,r){baseMerge(e,t,r)}));const merge$1=merge;function min(e){return e&&e.length?baseExtremum(e,identity,baseLt):void 0}function minBy(e,t){return e&&e.length?baseExtremum(e,baseIteratee(t),baseLt):void 0}function baseSet(e,t,r,n){if(!isObject(e))return e;for(var a=-1,o=(t=castPath(t,e)).length,i=o-1,s=e;null!=s&&++a<o;){var u=toKey(t[a]),c=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(a!=i){var f=s[u];void 0===(c=n?n(f,u,s):void 0)&&(c=isObject(f)?f:isIndex(t[a+1])?[]:{})}assignValue(s,u,c),s=s[u]}return e}function basePickBy(e,t,r){for(var n=-1,a=t.length,o={};++n<a;){var i=t[n],s=baseGet(e,i);r(s,i)&&baseSet(o,castPath(i,e),s)}return o}function baseSortBy(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function compareAscending(e,t){if(e!==t){var r=void 0!==e,n=null===e,a=e==e,o=isSymbol(e),i=void 0!==t,s=null===t,u=t==t,c=isSymbol(t);if(!s&&!c&&!o&&e>t||o&&i&&u&&!s&&!c||n&&i&&u||!r&&u||!a)return 1;if(!n&&!o&&!c&&e<t||c&&r&&a&&!n&&!o||s&&r&&a||!i&&a||!u)return-1}return 0}function compareMultiple(e,t,r){for(var n=-1,a=e.criteria,o=t.criteria,i=a.length,s=r.length;++n<i;){var u=compareAscending(a[n],o[n]);if(u)return n>=s?u:u*("desc"==r[n]?-1:1)}return e.index-t.index}function baseOrderBy(e,t,r){t=t.length?arrayMap(t,(function(e){return isArray(e)?function(t){return baseGet(t,1===e.length?e[0]:e)}:e})):[identity];var n=-1;return t=arrayMap(t,baseUnary(baseIteratee)),baseSortBy(baseMap(e,(function(e,r,a){return{criteria:arrayMap(t,(function(t){return t(e)})),index:++n,value:e}})),(function(e,t){return compareMultiple(e,t,r)}))}function basePick(e,t){return basePickBy(e,t,(function(t,r){return hasIn(e,r)}))}var pick=flatRest((function(e,t){return null==e?{}:basePick(e,t)}));const pick$1=pick;var nativeCeil=Math.ceil,nativeMax=Math.max;function baseRange(e,t,r,n){for(var a=-1,o=nativeMax(nativeCeil((t-e)/(r||1)),0),i=Array(o);o--;)i[n?o:++a]=e,e+=r;return i}function createRange(e){return function(t,r,n){return n&&"number"!=typeof n&&isIterateeCall(t,r,n)&&(r=n=void 0),t=toFinite(t),void 0===r?(r=t,t=0):r=toFinite(r),baseRange(t,r,n=void 0===n?t<r?1:-1:toFinite(n),e)}}var range=createRange();const range$1=range;function baseReduce(e,t,r,n,a){return a(e,(function(e,a,o){r=n?(n=!1,e):t(r,e,a,o)})),r}function reduce(e,t,r){var n=isArray(e)?arrayReduce:baseReduce,a=arguments.length<3;return n(e,baseIteratee(t),r,a,baseEach$1)}var sortBy=baseRest((function(e,t){if(null==e)return[];var r=t.length;return r>1&&isIterateeCall(e,t[0],t[1])?t=[]:r>2&&isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),baseOrderBy(e,baseFlatten(t,1),[])}));const sortBy$1=sortBy;var INFINITY=1/0,createSet=Set&&1/setToArray(new Set([,-0]))[1]==INFINITY?function(e){return new Set(e)}:noop;const createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(e,t,r){var n=-1,a=arrayIncludes,o=e.length,i=!0,s=[],u=s;if(r)i=!1,a=arrayIncludesWith;else if(o>=LARGE_ARRAY_SIZE){var c=t?null:createSet$1(e);if(c)return setToArray(c);i=!1,a=cacheHas,u=new SetCache}else u=t?[]:s;e:for(;++n<o;){var f=e[n],d=t?t(f):f;if(f=r||0!==f?f:0,i&&d==d){for(var l=u.length;l--;)if(u[l]===d)continue e;t&&u.push(d),s.push(f)}else a(u,d,r)||(u!==s&&u.push(d),s.push(f))}return s}var union=baseRest((function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject,!0))}));const union$1=union;var idCounter=0;function uniqueId(e){var t=++idCounter;return toString(e)+t}function baseZipObject(e,t,r){for(var n=-1,a=e.length,o=t.length,i={};++n<a;){var s=n<o?t[n]:void 0;r(i,e[n],s)}return i}function zipObject(e,t){return baseZipObject(e||[],t||[],assignValue)}var DEFAULT_EDGE_NAME="\0",GRAPH_NODE="\0",EDGE_KEY_DELIM="";class Graph{constructor(e={}){this._isDirected=!has(e,"directed")||e.directed,this._isMultigraph=!!has(e,"multigraph")&&e.multigraph,this._isCompound=!!has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=constant(void 0),this._defaultEdgeLabelFn=constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[GRAPH_NODE]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return isFunction(e)||(e=constant(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return keys(this._nodes)}sources(){var e=this;return filter(this.nodes(),(function(t){return isEmpty(e._in[t])}))}sinks(){var e=this;return filter(this.nodes(),(function(t){return isEmpty(e._out[t])}))}setNodes(e,t){var r=arguments,n=this;return forEach(e,(function(e){r.length>1?n.setNode(e,t):n.setNode(e)})),this}setNode(e,t){return has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=GRAPH_NODE,this._children[e]={},this._children[GRAPH_NODE][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return has(this._nodes,e)}removeNode(e){var t=this;if(has(this._nodes,e)){var r=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],forEach(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),forEach(keys(this._in[e]),r),delete this._in[e],delete this._preds[e],forEach(keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(isUndefined(t))t=GRAPH_NODE;else{for(var r=t+="";!isUndefined(r);r=this.parent(r))if(r===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==GRAPH_NODE)return t}}children(e){if(isUndefined(e)&&(e=GRAPH_NODE),this._isCompound){var t=this._children[e];if(t)return keys(t)}else{if(e===GRAPH_NODE)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var t=this._preds[e];if(t)return keys(t)}successors(e){var t=this._sucs[e];if(t)return keys(t)}neighbors(e){var t=this.predecessors(e);if(t)return union$1(t,this.successors(e))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var r=this;forEach(this._nodes,(function(r,n){e(n)&&t.setNode(n,r)})),forEach(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,r.edge(e))}));var n={};function a(e){var o=r.parent(e);return void 0===o||t.hasNode(o)?(n[e]=o,o):o in n?n[o]:a(o)}return this._isCompound&&forEach(t.nodes(),(function(e){t.setParent(e,a(e))})),t}setDefaultEdgeLabel(e){return isFunction(e)||(e=constant(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return values(this._edgeObjs)}setPath(e,t){var r=this,n=arguments;return reduce(e,(function(e,a){return n.length>1?r.setEdge(e,a,t):r.setEdge(e,a),a})),this}setEdge(){var e,t,r,n,a=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,r=o.name,2===arguments.length&&(n=arguments[1],a=!0)):(e=o,t=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],a=!0)),e=""+e,t=""+t,isUndefined(r)||(r=""+r);var i=edgeArgsToId(this._isDirected,e,t,r);if(has(this._edgeLabels,i))return a&&(this._edgeLabels[i]=n),this;if(!isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[i]=a?n:this._defaultEdgeLabelFn(e,t,r);var s=edgeArgsToObj(this._isDirected,e,t,r);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[i]=s,incrementOrInitEntry(this._preds[t],e),incrementOrInitEntry(this._sucs[e],t),this._in[t][i]=s,this._out[e][i]=s,this._edgeCount++,this}edge(e,t,r){var n=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,e,t,r);return this._edgeLabels[n]}hasEdge(e,t,r){var n=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,e,t,r);return has(this._edgeLabels,n)}removeEdge(e,t,r){var n=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,e,t,r),a=this._edgeObjs[n];return a&&(e=a.v,t=a.w,delete this._edgeLabels[n],delete this._edgeObjs[n],decrementOrRemoveEntry(this._preds[t],e),decrementOrRemoveEntry(this._sucs[e],t),delete this._in[t][n],delete this._out[e][n],this._edgeCount--),this}inEdges(e,t){var r=this._in[e];if(r){var n=values(r);return t?filter(n,(function(e){return e.v===t})):n}}outEdges(e,t){var r=this._out[e];if(r){var n=values(r);return t?filter(n,(function(e){return e.w===t})):n}}nodeEdges(e,t){var r=this.inEdges(e,t);if(r)return r.concat(this.outEdges(e,t))}}function incrementOrInitEntry(e,t){e[t]?e[t]++:e[t]=1}function decrementOrRemoveEntry(e,t){--e[t]||delete e[t]}function edgeArgsToId(e,t,r,n){var a=""+t,o=""+r;if(!e&&a>o){var i=a;a=o,o=i}return a+EDGE_KEY_DELIM+o+EDGE_KEY_DELIM+(isUndefined(n)?DEFAULT_EDGE_NAME:n)}function edgeArgsToObj(e,t,r,n){var a=""+t,o=""+r;if(!e&&a>o){var i=a;a=o,o=i}var s={v:a,w:o};return n&&(s.name=n),s}function edgeObjToId(e,t){return edgeArgsToId(e,t.v,t.w,t.name)}Graph.prototype._nodeCount=0,Graph.prototype._edgeCount=0;class List{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return unlink(t),t}enqueue(e){var t=this._sentinel;e._prev&&e._next&&unlink(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,filterOutLinks)),r=r._prev;return"["+e.join(", ")+"]"}}function unlink(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function filterOutLinks(e,t){if("_next"!==e&&"_prev"!==e)return t}var DEFAULT_WEIGHT_FN=constant(1);function greedyFAS(e,t){if(e.nodeCount()<=1)return[];var r=buildState(e,t||DEFAULT_WEIGHT_FN);return flatten(map(doGreedyFAS(r.graph,r.buckets,r.zeroIdx),(function(t){return e.outEdges(t.v,t.w)})))}function doGreedyFAS(e,t,r){for(var n,a=[],o=t[t.length-1],i=t[0];e.nodeCount();){for(;n=i.dequeue();)removeNode(e,t,r,n);for(;n=o.dequeue();)removeNode(e,t,r,n);if(e.nodeCount())for(var s=t.length-2;s>0;--s)if(n=t[s].dequeue()){a=a.concat(removeNode(e,t,r,n,!0));break}}return a}function removeNode(e,t,r,n,a){var o=a?[]:void 0;return forEach(e.inEdges(n.v),(function(n){var i=e.edge(n),s=e.node(n.v);a&&o.push({v:n.v,w:n.w}),s.out-=i,assignBucket(t,r,s)})),forEach(e.outEdges(n.v),(function(n){var a=e.edge(n),o=n.w,i=e.node(o);i.in-=a,assignBucket(t,r,i)})),e.removeNode(n.v),o}function buildState(e,t){var r=new Graph,n=0,a=0;forEach(e.nodes(),(function(e){r.setNode(e,{v:e,in:0,out:0})})),forEach(e.edges(),(function(e){var o=r.edge(e.v,e.w)||0,i=t(e),s=o+i;r.setEdge(e.v,e.w,s),a=Math.max(a,r.node(e.v).out+=i),n=Math.max(n,r.node(e.w).in+=i)}));var o=range$1(a+n+3).map((function(){return new List})),i=n+1;return forEach(r.nodes(),(function(e){assignBucket(o,i,r.node(e))})),{graph:r,buckets:o,zeroIdx:i}}function assignBucket(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}function run$2(e){var t;forEach("greedy"===e.graph().acyclicer?greedyFAS(e,(t=e,function(e){return t.edge(e).weight})):dfsFAS(e),(function(t){var r=e.edge(t);e.removeEdge(t),r.forwardName=t.name,r.reversed=!0,e.setEdge(t.w,t.v,r,uniqueId("rev"))}))}function dfsFAS(e){var t=[],r={},n={};return forEach(e.nodes(),(function a(o){has(n,o)||(n[o]=!0,r[o]=!0,forEach(e.outEdges(o),(function(e){has(r,e.w)?t.push(e):a(e.w)})),delete r[o])})),t}function undo$2(e){forEach(e.edges(),(function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}}))}function addDummyNode(e,t,r,n){var a;do{a=uniqueId(n)}while(e.hasNode(a));return r.dummy=t,e.setNode(a,r),a}function simplify(e){var t=(new Graph).setGraph(e.graph());return forEach(e.nodes(),(function(r){t.setNode(r,e.node(r))})),forEach(e.edges(),(function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},a=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+a.weight,minlen:Math.max(n.minlen,a.minlen)})})),t}function asNonCompoundGraph(e){var t=new Graph({multigraph:e.isMultigraph()}).setGraph(e.graph());return forEach(e.nodes(),(function(r){e.children(r).length||t.setNode(r,e.node(r))})),forEach(e.edges(),(function(r){t.setEdge(r,e.edge(r))})),t}function intersectRect(e,t){var r,n,a=e.x,o=e.y,i=t.x-a,s=t.y-o,u=e.width/2,c=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(i)*c?(s<0&&(c=-c),r=c*i/s,n=c):(i<0&&(u=-u),r=u,n=u*s/i),{x:a+r,y:o+n}}function buildLayerMatrix(e){var t=map(range$1(maxRank(e)+1),(function(){return[]}));return forEach(e.nodes(),(function(r){var n=e.node(r),a=n.rank;isUndefined(a)||(t[a][n.order]=r)})),t}function normalizeRanks(e){var t=min(map(e.nodes(),(function(t){return e.node(t).rank})));forEach(e.nodes(),(function(r){var n=e.node(r);has(n,"rank")&&(n.rank-=t)}))}function removeEmptyRanks(e){var t=min(map(e.nodes(),(function(t){return e.node(t).rank}))),r=[];forEach(e.nodes(),(function(n){var a=e.node(n).rank-t;r[a]||(r[a]=[]),r[a].push(n)}));var n=0,a=e.graph().nodeRankFactor;forEach(r,(function(t,r){isUndefined(t)&&r%a!=0?--n:n&&forEach(t,(function(t){e.node(t).rank+=n}))}))}function addBorderNode$1(e,t,r,n){var a={width:0,height:0};return arguments.length>=4&&(a.rank=r,a.order=n),addDummyNode(e,"border",a,t)}function maxRank(e){return max(map(e.nodes(),(function(t){var r=e.node(t).rank;if(!isUndefined(r))return r})))}function partition(e,t){var r={lhs:[],rhs:[]};return forEach(e,(function(e){t(e)?r.lhs.push(e):r.rhs.push(e)})),r}function time(e,t){var r=now$1();try{return t()}finally{console.log(e+" time: "+(now$1()-r)+"ms")}}function notime(e,t){return t()}function addBorderSegments(e){forEach(e.children(),(function t(r){var n=e.children(r),a=e.node(r);if(n.length&&forEach(n,t),has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var o=a.minRank,i=a.maxRank+1;o<i;++o)addBorderNode(e,"borderLeft","_bl",r,a,o),addBorderNode(e,"borderRight","_br",r,a,o)}}))}function addBorderNode(e,t,r,n,a,o){var i={width:0,height:0,rank:o,borderType:t},s=a[t][o-1],u=addDummyNode(e,"border",i,r);a[t][o]=u,e.setParent(u,n),s&&e.setEdge(s,u,{weight:1})}function adjust(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||swapWidthHeight(e)}function undo$1(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||reverseY(e),"lr"!==t&&"rl"!==t||(swapXY(e),swapWidthHeight(e))}function swapWidthHeight(e){forEach(e.nodes(),(function(t){swapWidthHeightOne(e.node(t))})),forEach(e.edges(),(function(t){swapWidthHeightOne(e.edge(t))}))}function swapWidthHeightOne(e){var t=e.width;e.width=e.height,e.height=t}function reverseY(e){forEach(e.nodes(),(function(t){reverseYOne(e.node(t))})),forEach(e.edges(),(function(t){var r=e.edge(t);forEach(r.points,reverseYOne),has(r,"y")&&reverseYOne(r)}))}function reverseYOne(e){e.y=-e.y}function swapXY(e){forEach(e.nodes(),(function(t){swapXYOne(e.node(t))})),forEach(e.edges(),(function(t){var r=e.edge(t);forEach(r.points,swapXYOne),has(r,"x")&&swapXYOne(r)}))}function swapXYOne(e){var t=e.x;e.x=e.y,e.y=t}function run$1(e){e.graph().dummyChains=[],forEach(e.edges(),(function(t){normalizeEdge(e,t)}))}function normalizeEdge(e,t){var r=t.v,n=e.node(r).rank,a=t.w,o=e.node(a).rank,i=t.name,s=e.edge(t),u=s.labelRank;if(o!==n+1){var c,f,d;for(e.removeEdge(t),d=0,++n;n<o;++d,++n)s.points=[],c=addDummyNode(e,"edge",f={width:0,height:0,edgeLabel:s,edgeObj:t,rank:n},"_d"),n===u&&(f.width=s.width,f.height=s.height,f.dummy="edge-label",f.labelpos=s.labelpos),e.setEdge(r,c,{weight:s.weight},i),0===d&&e.graph().dummyChains.push(c),r=c;e.setEdge(r,a,{weight:s.weight},i)}}function undo(e){forEach(e.graph().dummyChains,(function(t){var r,n=e.node(t),a=n.edgeLabel;for(e.setEdge(n.edgeObj,a);n.dummy;)r=e.successors(t)[0],e.removeNode(t),a.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(a.x=n.x,a.y=n.y,a.width=n.width,a.height=n.height),t=r,n=e.node(t)}))}function longestPath(e){var t={};forEach(e.sources(),(function r(n){var a=e.node(n);if(has(t,n))return a.rank;t[n]=!0;var o=min(map(e.outEdges(n),(function(t){return r(t.w)-e.edge(t).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),a.rank=o}))}function slack(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function feasibleTree(e){var t,r,n=new Graph({directed:!1}),a=e.nodes()[0],o=e.nodeCount();for(n.setNode(a,{});tightTree(n,e)<o;)t=findMinSlackEdge(n,e),r=n.hasNode(t.v)?slack(e,t):-slack(e,t),shiftRanks(n,e,r);return n}function tightTree(e,t){return forEach(e.nodes(),(function r(n){forEach(t.nodeEdges(n),(function(a){var o=a.v,i=n===o?a.w:o;e.hasNode(i)||slack(t,a)||(e.setNode(i,{}),e.setEdge(n,i,{}),r(i))}))})),e.nodeCount()}function findMinSlackEdge(e,t){return minBy(t.edges(),(function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return slack(t,r)}))}function shiftRanks(e,t,r){forEach(e.nodes(),(function(e){t.node(e).rank+=r}))}function CycleException(){}function dfs$1(e,t,r){isArray(t)||(t=[t]);var n=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],o={};return forEach(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);doDfs(e,t,"post"===r,o,n,a)})),a}function doDfs(e,t,r,n,a,o){has(n,t)||(n[t]=!0,r||o.push(t),forEach(a(t),(function(t){doDfs(e,t,r,n,a,o)})),r&&o.push(t))}function postorder$1(e,t){return dfs$1(e,t,"post")}function preorder(e,t){return dfs$1(e,t,"pre")}function networkSimplex(e){longestPath(e=simplify(e));var t,r=feasibleTree(e);for(initLowLimValues(r),initCutValues(r,e);t=leaveEdge(r);)exchangeEdges(r,e,t,enterEdge(r,e,t))}function initCutValues(e,t){var r=postorder$1(e,e.nodes());forEach(r=r.slice(0,r.length-1),(function(r){assignCutValue(e,t,r)}))}function assignCutValue(e,t,r){var n=e.node(r).parent;e.edge(r,n).cutvalue=calcCutValue(e,t,r)}function calcCutValue(e,t,r){var n=e.node(r).parent,a=!0,o=t.edge(r,n),i=0;return o||(a=!1,o=t.edge(n,r)),i=o.weight,forEach(t.nodeEdges(r),(function(o){var s=o.v===r,u=s?o.w:o.v;if(u!==n){var c=s===a,f=t.edge(o).weight;if(i+=c?f:-f,isTreeEdge(e,r,u)){var d=e.edge(r,u).cutvalue;i+=c?-d:d}}})),i}function initLowLimValues(e,t){arguments.length<2&&(t=e.nodes()[0]),dfsAssignLowLim(e,{},1,t)}function dfsAssignLowLim(e,t,r,n,a){var o=r,i=e.node(n);return t[n]=!0,forEach(e.neighbors(n),(function(a){has(t,a)||(r=dfsAssignLowLim(e,t,r,a,n))})),i.low=o,i.lim=r++,a?i.parent=a:delete i.parent,r}function leaveEdge(e){return find$1(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function enterEdge(e,t,r){var n=r.v,a=r.w;t.hasEdge(n,a)||(n=r.w,a=r.v);var o=e.node(n),i=e.node(a),s=o,u=!1;return o.lim>i.lim&&(s=i,u=!0),minBy(filter(t.edges(),(function(t){return u===isDescendant(e,e.node(t.v),s)&&u!==isDescendant(e,e.node(t.w),s)})),(function(e){return slack(t,e)}))}function exchangeEdges(e,t,r,n){var a=r.v,o=r.w;e.removeEdge(a,o),e.setEdge(n.v,n.w,{}),initLowLimValues(e),initCutValues(e,t),updateRanks(e,t)}function updateRanks(e,t){var r=find$1(e.nodes(),(function(e){return!t.node(e).parent})),n=preorder(e,r);forEach(n=n.slice(1),(function(r){var n=e.node(r).parent,a=t.edge(r,n),o=!1;a||(a=t.edge(n,r),o=!0),t.node(r).rank=t.node(n).rank+(o?a.minlen:-a.minlen)}))}function isTreeEdge(e,t,r){return e.hasEdge(t,r)}function isDescendant(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}function rank(e){switch(e.graph().ranker){case"network-simplex":default:networkSimplexRanker(e);break;case"tight-tree":tightTreeRanker(e);break;case"longest-path":longestPathRanker(e)}}CycleException.prototype=new Error,networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges;var longestPathRanker=longestPath;function tightTreeRanker(e){longestPath(e),feasibleTree(e)}function networkSimplexRanker(e){networkSimplex(e)}function run(e){var t=addDummyNode(e,"root",{},"_root"),r=treeDepths(e),n=max(values(r))-1,a=2*n+1;e.graph().nestingRoot=t,forEach(e.edges(),(function(t){e.edge(t).minlen*=a}));var o=sumWeights(e)+1;forEach(e.children(),(function(i){dfs(e,t,a,o,n,r,i)})),e.graph().nodeRankFactor=a}function dfs(e,t,r,n,a,o,i){var s=e.children(i);if(s.length){var u=addBorderNode$1(e,"_bt"),c=addBorderNode$1(e,"_bb"),f=e.node(i);e.setParent(u,i),f.borderTop=u,e.setParent(c,i),f.borderBottom=c,forEach(s,(function(s){dfs(e,t,r,n,a,o,s);var f=e.node(s),d=f.borderTop?f.borderTop:s,l=f.borderBottom?f.borderBottom:s,h=f.borderTop?n:2*n,g=d!==l?1:a-o[i]+1;e.setEdge(u,d,{weight:h,minlen:g,nestingEdge:!0}),e.setEdge(l,c,{weight:h,minlen:g,nestingEdge:!0})})),e.parent(i)||e.setEdge(t,u,{weight:0,minlen:a+o[i]})}else i!==t&&e.setEdge(t,i,{weight:0,minlen:r})}function treeDepths(e){var t={};function r(n,a){var o=e.children(n);o&&o.length&&forEach(o,(function(e){r(e,a+1)})),t[n]=a}return forEach(e.children(),(function(e){r(e,1)})),t}function sumWeights(e){return reduce(e.edges(),(function(t,r){return t+e.edge(r).weight}),0)}function cleanup(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}function addSubgraphConstraints(e,t,r){var n,a={};forEach(r,(function(r){for(var o,i,s=e.parent(r);s;){if((o=e.parent(s))?(i=a[o],a[o]=s):(i=n,n=s),i&&i!==s)return void t.setEdge(i,s);s=o}}))}function buildLayerGraph(e,t,r){var n=createRootNode(e),a=new Graph({compound:!0}).setGraph({root:n}).setDefaultNodeLabel((function(t){return e.node(t)}));return forEach(e.nodes(),(function(o){var i=e.node(o),s=e.parent(o);(i.rank===t||i.minRank<=t&&t<=i.maxRank)&&(a.setNode(o),a.setParent(o,s||n),forEach(e[r](o),(function(t){var r=t.v===o?t.w:t.v,n=a.edge(r,o),i=isUndefined(n)?0:n.weight;a.setEdge(r,o,{weight:e.edge(t).weight+i})})),has(i,"minRank")&&a.setNode(o,{borderLeft:i.borderLeft[t],borderRight:i.borderRight[t]}))})),a}function createRootNode(e){for(var t;e.hasNode(t=uniqueId("_root")););return t}function crossCount(e,t){for(var r=0,n=1;n<t.length;++n)r+=twoLayerCrossCount(e,t[n-1],t[n]);return r}function twoLayerCrossCount(e,t,r){for(var n=zipObject(r,map(r,(function(e,t){return t}))),a=flatten(map(t,(function(t){return sortBy$1(map(e.outEdges(t),(function(t){return{pos:n[t.w],weight:e.edge(t).weight}})),"pos")}))),o=1;o<r.length;)o<<=1;var i=2*o-1;o-=1;var s=map(new Array(i),(function(){return 0})),u=0;return forEach(a.forEach((function(e){var t=e.pos+o;s[t]+=e.weight;for(var r=0;t>0;)t%2&&(r+=s[t+1]),s[t=t-1>>1]+=e.weight;u+=e.weight*r}))),u}function initOrder(e){var t={},r=filter(e.nodes(),(function(t){return!e.children(t).length})),n=max(map(r,(function(t){return e.node(t).rank}))),a=map(range$1(n+1),(function(){return[]}));return forEach(sortBy$1(r,(function(t){return e.node(t).rank})),(function r(n){if(!has(t,n)){t[n]=!0;var o=e.node(n);a[o.rank].push(n),forEach(e.successors(n),r)}})),a}function barycenter(e,t){return map(t,(function(t){var r=e.inEdges(t);if(r.length){var n=reduce(r,(function(t,r){var n=e.edge(r),a=e.node(r.v);return{sum:t.sum+n.weight*a.order,weight:t.weight+n.weight}}),{sum:0,weight:0});return{v:t,barycenter:n.sum/n.weight,weight:n.weight}}return{v:t}}))}function resolveConflicts(e,t){var r={};return forEach(e,(function(e,t){var n=r[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};isUndefined(e.barycenter)||(n.barycenter=e.barycenter,n.weight=e.weight)})),forEach(t.edges(),(function(e){var t=r[e.v],n=r[e.w];isUndefined(t)||isUndefined(n)||(n.indegree++,t.out.push(r[e.w]))})),doResolveConflicts(filter(r,(function(e){return!e.indegree})))}function doResolveConflicts(e){var t=[];function r(e){return function(t){t.merged||(isUndefined(t.barycenter)||isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&mergeEntries(e,t)}}function n(t){return function(r){r.in.push(t),0==--r.indegree&&e.push(r)}}for(;e.length;){var a=e.pop();t.push(a),forEach(a.in.reverse(),r(a)),forEach(a.out,n(a))}return map(filter(t,(function(e){return!e.merged})),(function(e){return pick$1(e,["vs","i","barycenter","weight"])}))}function mergeEntries(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}function sort(e,t){var r=partition(e,(function(e){return has(e,"barycenter")})),n=r.lhs,a=sortBy$1(r.rhs,(function(e){return-e.i})),o=[],i=0,s=0,u=0;n.sort(compareWithBias(!!t)),u=consumeUnsortable(o,a,u),forEach(n,(function(e){u+=e.vs.length,o.push(e.vs),i+=e.barycenter*e.weight,s+=e.weight,u=consumeUnsortable(o,a,u)}));var c={vs:flatten(o)};return s&&(c.barycenter=i/s,c.weight=s),c}function consumeUnsortable(e,t,r){for(var n;t.length&&(n=last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function compareWithBias(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}function sortSubgraph(e,t,r,n){var a=e.children(t),o=e.node(t),i=o?o.borderLeft:void 0,s=o?o.borderRight:void 0,u={};i&&(a=filter(a,(function(e){return e!==i&&e!==s})));var c=barycenter(e,a);forEach(c,(function(t){if(e.children(t.v).length){var a=sortSubgraph(e,t.v,r,n);u[t.v]=a,has(a,"barycenter")&&mergeBarycenters(t,a)}}));var f=resolveConflicts(c,r);expandSubgraphs(f,u);var d=sort(f,n);if(i&&(d.vs=flatten([i,d.vs,s]),e.predecessors(i).length)){var l=e.node(e.predecessors(i)[0]),h=e.node(e.predecessors(s)[0]);has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+l.order+h.order)/(d.weight+2),d.weight+=2}return d}function expandSubgraphs(e,t){forEach(e,(function(e){e.vs=flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})))}))}function mergeBarycenters(e,t){isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}function order(e){var t=maxRank(e),r=buildLayerGraphs(e,range$1(1,t+1),"inEdges"),n=buildLayerGraphs(e,range$1(t-1,-1,-1),"outEdges"),a=initOrder(e);assignOrder(e,a);for(var o,i=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){sweepLayerGraphs(s%2?r:n,s%4>=2);var c=crossCount(e,a=buildLayerMatrix(e));c<i&&(u=0,o=cloneDeep(a),i=c)}assignOrder(e,o)}function buildLayerGraphs(e,t,r){return map(t,(function(t){return buildLayerGraph(e,t,r)}))}function sweepLayerGraphs(e,t){var r=new Graph;forEach(e,(function(e){var n=e.graph().root,a=sortSubgraph(e,n,r,t);forEach(a.vs,(function(t,r){e.node(t).order=r})),addSubgraphConstraints(e,r,a.vs)}))}function assignOrder(e,t){forEach(t,(function(t){forEach(t,(function(t,r){e.node(t).order=r}))}))}function parentDummyChains(e){var t=postorder(e);forEach(e.graph().dummyChains,(function(r){for(var n=e.node(r),a=n.edgeObj,o=findPath(e,t,a.v,a.w),i=o.path,s=o.lca,u=0,c=i[u],f=!0;r!==a.w;){if(n=e.node(r),f){for(;(c=i[u])!==s&&e.node(c).maxRank<n.rank;)u++;c===s&&(f=!1)}if(!f){for(;u<i.length-1&&e.node(c=i[u+1]).minRank<=n.rank;)u++;c=i[u]}e.setParent(r,c),r=e.successors(r)[0]}}))}function findPath(e,t,r,n){var a,o,i=[],s=[],u=Math.min(t[r].low,t[n].low),c=Math.max(t[r].lim,t[n].lim);a=r;do{a=e.parent(a),i.push(a)}while(a&&(t[a].low>u||c>t[a].lim));for(o=a,a=n;(a=e.parent(a))!==o;)s.push(a);return{path:i.concat(s.reverse()),lca:o}}function postorder(e){var t={},r=0;return forEach(e.children(),(function n(a){var o=r;forEach(e.children(a),n),t[a]={low:o,lim:r++}})),t}function findType1Conflicts(e,t){var r={};return reduce(t,(function(t,n){var a=0,o=0,i=t.length,s=last(n);return forEach(n,(function(t,u){var c=findOtherInnerSegmentNode(e,t),f=c?e.node(c).order:i;(c||t===s)&&(forEach(n.slice(o,u+1),(function(t){forEach(e.predecessors(t),(function(n){var o=e.node(n),i=o.order;!(i<a||f<i)||o.dummy&&e.node(t).dummy||addConflict(r,n,t)}))})),o=u+1,a=f)})),n})),r}function findType2Conflicts(e,t){var r={};function n(t,n,a,o,i){var s;forEach(range$1(n,a),(function(n){s=t[n],e.node(s).dummy&&forEach(e.predecessors(s),(function(t){var n=e.node(t);n.dummy&&(n.order<o||n.order>i)&&addConflict(r,t,s)}))}))}return reduce(t,(function(t,r){var a,o=-1,i=0;return forEach(r,(function(s,u){if("border"===e.node(s).dummy){var c=e.predecessors(s);c.length&&(a=e.node(c[0]).order,n(r,i,u,o,a),i=u,o=a)}n(r,i,r.length,a,t.length)})),r})),r}function findOtherInnerSegmentNode(e,t){if(e.node(t).dummy)return find$1(e.predecessors(t),(function(t){return e.node(t).dummy}))}function addConflict(e,t,r){if(t>r){var n=t;t=r,r=n}var a=e[t];a||(e[t]=a={}),a[r]=!0}function hasConflict(e,t,r){if(t>r){var n=t;t=r,r=n}return has(e[t],r)}function verticalAlignment(e,t,r,n){var a={},o={},i={};return forEach(t,(function(e){forEach(e,(function(e,t){a[e]=e,o[e]=e,i[e]=t}))})),forEach(t,(function(e){var t=-1;forEach(e,(function(e){var s=n(e);if(s.length)for(var u=((s=sortBy$1(s,(function(e){return i[e]}))).length-1)/2,c=Math.floor(u),f=Math.ceil(u);c<=f;++c){var d=s[c];o[e]===e&&t<i[d]&&!hasConflict(r,e,d)&&(o[d]=e,o[e]=a[e]=a[d],t=i[d])}}))})),{root:a,align:o}}function horizontalCompaction(e,t,r,n,a){var o={},i=buildBlockGraph(e,t,r,a),s=a?"borderLeft":"borderRight";function u(e,t){for(var r=i.nodes(),n=r.pop(),a={};n;)a[n]?e(n):(a[n]=!0,r.push(n),r=r.concat(t(n))),n=r.pop()}return u((function(e){o[e]=i.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+i.edge(t))}),0)}),i.predecessors.bind(i)),u((function(t){var r=i.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-i.edge(t))}),Number.POSITIVE_INFINITY),n=e.node(t);r!==Number.POSITIVE_INFINITY&&n.borderType!==s&&(o[t]=Math.max(o[t],r))}),i.successors.bind(i)),forEach(n,(function(e){o[e]=o[r[e]]})),o}function buildBlockGraph(e,t,r,n){var a=new Graph,o=e.graph(),i=sep(o.nodesep,o.edgesep,n);return forEach(t,(function(t){var n;forEach(t,(function(t){var o=r[t];if(a.setNode(o),n){var s=r[n],u=a.edge(s,o);a.setEdge(s,o,Math.max(i(e,t,n),u||0))}n=t}))})),a}function findSmallestWidthAlignment(e,t){return minBy(values(t),(function(t){var r=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;return forIn(t,(function(t,a){var o=width(e,a)/2;r=Math.max(t+o,r),n=Math.min(t-o,n)})),r-n}))}function alignCoordinates(e,t){var r=values(t),n=min(r),a=max(r);forEach(["u","d"],(function(r){forEach(["l","r"],(function(o){var i,s=r+o,u=e[s];if(u!==t){var c=values(u);(i="l"===o?n-min(c):a-max(c))&&(e[s]=mapValues(u,(function(e){return e+i})))}}))}))}function balance(e,t){return mapValues(e.ul,(function(r,n){if(t)return e[t.toLowerCase()][n];var a=sortBy$1(map(e,n));return(a[1]+a[2])/2}))}function positionX(e){var t,r=buildLayerMatrix(e),n=merge$1(findType1Conflicts(e,r),findType2Conflicts(e,r)),a={};forEach(["u","d"],(function(o){t="u"===o?r:values(r).reverse(),forEach(["l","r"],(function(r){"r"===r&&(t=map(t,(function(e){return values(e).reverse()})));var i=("u"===o?e.predecessors:e.successors).bind(e),s=verticalAlignment(e,t,n,i),u=horizontalCompaction(e,t,s.root,s.align,"r"===r);"r"===r&&(u=mapValues(u,(function(e){return-e}))),a[o+r]=u}))}));var o=findSmallestWidthAlignment(e,a);return alignCoordinates(a,o),balance(a,e.graph().align)}function sep(e,t,r){return function(n,a,o){var i,s=n.node(a),u=n.node(o),c=0;if(c+=s.width/2,has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":i=-s.width/2;break;case"r":i=s.width/2}if(i&&(c+=r?i:-i),i=0,c+=(s.dummy?t:e)/2,c+=(u.dummy?t:e)/2,c+=u.width/2,has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":i=u.width/2;break;case"r":i=-u.width/2}return i&&(c+=r?i:-i),i=0,c}}function width(e,t){return e.node(t).width}function position(e){positionY(e=asNonCompoundGraph(e)),forOwn(positionX(e),(function(t,r){e.node(r).x=t}))}function positionY(e){var t=buildLayerMatrix(e),r=e.graph().ranksep,n=0;forEach(t,(function(t){var a=max(map(t,(function(t){return e.node(t).height})));forEach(t,(function(t){e.node(t).y=n+a/2})),n+=a+r}))}function layout(e,t){var r=t&&t.debugTiming?time:notime;r("layout",(function(){var t=r("  buildLayoutGraph",(function(){return buildLayoutGraph(e)}));r("  runLayout",(function(){runLayout(t,r)})),r("  updateInputGraph",(function(){updateInputGraph(e,t)}))}))}function runLayout(e,t){t("    makeSpaceForEdgeLabels",(function(){makeSpaceForEdgeLabels(e)})),t("    removeSelfEdges",(function(){removeSelfEdges(e)})),t("    acyclic",(function(){run$2(e)})),t("    nestingGraph.run",(function(){run(e)})),t("    rank",(function(){rank(asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){injectEdgeLabelProxies(e)})),t("    removeEmptyRanks",(function(){removeEmptyRanks(e)})),t("    nestingGraph.cleanup",(function(){cleanup(e)})),t("    normalizeRanks",(function(){normalizeRanks(e)})),t("    assignRankMinMax",(function(){assignRankMinMax(e)})),t("    removeEdgeLabelProxies",(function(){removeEdgeLabelProxies(e)})),t("    normalize.run",(function(){run$1(e)})),t("    parentDummyChains",(function(){parentDummyChains(e)})),t("    addBorderSegments",(function(){addBorderSegments(e)})),t("    order",(function(){order(e)})),t("    insertSelfEdges",(function(){insertSelfEdges(e)})),t("    adjustCoordinateSystem",(function(){adjust(e)})),t("    position",(function(){position(e)})),t("    positionSelfEdges",(function(){positionSelfEdges(e)})),t("    removeBorderNodes",(function(){removeBorderNodes(e)})),t("    normalize.undo",(function(){undo(e)})),t("    fixupEdgeLabelCoords",(function(){fixupEdgeLabelCoords(e)})),t("    undoCoordinateSystem",(function(){undo$1(e)})),t("    translateGraph",(function(){translateGraph(e)})),t("    assignNodeIntersects",(function(){assignNodeIntersects(e)})),t("    reversePoints",(function(){reversePointsForReversedEdges(e)})),t("    acyclic.undo",(function(){undo$2(e)}))}function updateInputGraph(e,t){forEach(e.nodes(),(function(r){var n=e.node(r),a=t.node(r);n&&(n.x=a.x,n.y=a.y,t.children(r).length&&(n.width=a.width,n.height=a.height))})),forEach(e.edges(),(function(r){var n=e.edge(r),a=t.edge(r);n.points=a.points,has(a,"x")&&(n.x=a.x,n.y=a.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function buildLayoutGraph(e){var t=new Graph({multigraph:!0,compound:!0}),r=canonicalize(e.graph());return t.setGraph(merge$1({},graphDefaults,selectNumberAttrs(r,graphNumAttrs),pick$1(r,graphAttrs))),forEach(e.nodes(),(function(r){var n=canonicalize(e.node(r));t.setNode(r,defaults$1(selectNumberAttrs(n,nodeNumAttrs),nodeDefaults)),t.setParent(r,e.parent(r))})),forEach(e.edges(),(function(r){var n=canonicalize(e.edge(r));t.setEdge(r,merge$1({},edgeDefaults,selectNumberAttrs(n,edgeNumAttrs),pick$1(n,edgeAttrs)))})),t}function makeSpaceForEdgeLabels(e){var t=e.graph();t.ranksep/=2,forEach(e.edges(),(function(r){var n=e.edge(r);n.minlen*=2,"c"!==n.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?n.width+=n.labeloffset:n.height+=n.labeloffset)}))}function injectEdgeLabelProxies(e){forEach(e.edges(),(function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),a={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};addDummyNode(e,"edge-proxy",a,"_ep")}}))}function assignRankMinMax(e){var t=0;forEach(e.nodes(),(function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=max(t,n.maxRank))})),e.graph().maxRank=t}function removeEdgeLabelProxies(e){forEach(e.nodes(),(function(t){var r=e.node(t);"edge-proxy"===r.dummy&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))}))}function translateGraph(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,a=0,o=e.graph(),i=o.marginx||0,s=o.marginy||0;function u(e){var o=e.x,i=e.y,s=e.width,u=e.height;t=Math.min(t,o-s/2),r=Math.max(r,o+s/2),n=Math.min(n,i-u/2),a=Math.max(a,i+u/2)}forEach(e.nodes(),(function(t){u(e.node(t))})),forEach(e.edges(),(function(t){var r=e.edge(t);has(r,"x")&&u(r)})),t-=i,n-=s,forEach(e.nodes(),(function(r){var a=e.node(r);a.x-=t,a.y-=n})),forEach(e.edges(),(function(r){var a=e.edge(r);forEach(a.points,(function(e){e.x-=t,e.y-=n})),has(a,"x")&&(a.x-=t),has(a,"y")&&(a.y-=n)})),o.width=r-t+i,o.height=a-n+s}function assignNodeIntersects(e){forEach(e.edges(),(function(t){var r,n,a=e.edge(t),o=e.node(t.v),i=e.node(t.w);a.points?(r=a.points[0],n=a.points[a.points.length-1]):(a.points=[],r=i,n=o),a.points.unshift(intersectRect(o,r)),a.points.push(intersectRect(i,n))}))}function fixupEdgeLabelCoords(e){forEach(e.edges(),(function(t){var r=e.edge(t);if(has(r,"x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}}))}function reversePointsForReversedEdges(e){forEach(e.edges(),(function(t){var r=e.edge(t);r.reversed&&r.points.reverse()}))}function removeBorderNodes(e){forEach(e.nodes(),(function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),a=e.node(r.borderBottom),o=e.node(last(r.borderLeft)),i=e.node(last(r.borderRight));r.width=Math.abs(i.x-o.x),r.height=Math.abs(a.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}})),forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}function removeSelfEdges(e){forEach(e.edges(),(function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}function insertSelfEdges(e){forEach(buildLayerMatrix(e),(function(t){var r=0;forEach(t,(function(t,n){var a=e.node(t);a.order=n+r,forEach(a.selfEdges,(function(t){addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:a.rank,order:n+ ++r,e:t.e,label:t.label},"_se")})),delete a.selfEdges}))}))}function positionSelfEdges(e){forEach(e.nodes(),(function(t){var r=e.node(t);if("selfedge"===r.dummy){var n=e.node(r.e.v),a=n.x+n.width/2,o=n.y,i=r.x-a,s=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:a+2*i/3,y:o-s},{x:a+5*i/6,y:o-s},{x:a+i,y:o},{x:a+5*i/6,y:o+s},{x:a+2*i/3,y:o+s}],r.label.x=r.x,r.label.y=r.y}}))}function selectNumberAttrs(e,t){return mapValues(pick$1(e,t),Number)}function canonicalize(e){var t={};return forEach(e,(function(e,r){t[r.toLowerCase()]=e})),t}export{Graph as G,isUndefined as a,baseClone as b,defaults$1 as d,forEach as f,has as h,isPlainObject as i,layout as l,map as m,pick$1 as p,range$1 as r,uniqueId as u};