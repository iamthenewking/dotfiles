import{p as W,d as M,s as H}from"./styles-659d7242.js";import{c as S,l as d,j as m,k as X}from"./mermaid-42f7bf2b.js";import{G as Y,l as Z}from"./layout-c5a37d74.js";import{s as l}from"./svgDraw-af99a425.js";import"./line-ce5d1152.js";import"./array-2ff2c7a6.js";import"./constant-2fe7eae5.js";let h={};const g=20,p=function(t){const e=Object.entries(h).find((e=>e[1].label===t));if(e)return e[0]},D=function(t){t.append("defs").append("marker").attr("id","extensionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),t.append("defs").append("marker").attr("id","extensionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z"),t.append("defs").append("marker").attr("id","compositionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id","compositionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id","aggregationStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id","aggregationEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id","dependencyStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},$=function(t,e,a,r){const n=S().class;h={},d.info("Rendering diagram "+t);const i=S().securityLevel;let o;"sandbox"===i&&(o=m("#i"+e));const s=m("sandbox"===i?o.nodes()[0].contentDocument.body:"body"),f=s.select(`[id='${e}']`);D(f);const c=new Y({multigraph:!0});c.setGraph({isMultiGraph:!0}),c.setDefaultEdgeLabel((function(){return{}}));const u=r.db.getClasses(),k=Object.keys(u);for(const t of k){const e=u[t],a=l.drawClass(f,e,n,r);h[a.id]=a,c.setNode(a.id,a),d.info("Org height: "+a.height)}r.db.getRelations().forEach((function(t){d.info("tjoho"+p(t.id1)+p(t.id2)+JSON.stringify(t)),c.setEdge(p(t.id1),p(t.id2),{relation:t},t.title||"DEFAULT")})),r.db.getNotes().forEach((function(t){d.debug(`Adding note: ${JSON.stringify(t)}`);const e=l.drawNote(f,t,n,r);h[e.id]=e,c.setNode(e.id,e),t.class&&t.class in u&&c.setEdge(t.id,p(t.class),{relation:{id1:t.id,id2:t.class,relation:{type1:"none",type2:"none",lineType:10}}},"DEFAULT")})),Z(c),c.nodes().forEach((function(t){void 0!==t&&void 0!==c.node(t)&&(d.debug("Node "+t+": "+JSON.stringify(c.node(t))),s.select("#"+(r.db.lookUpDomId(t)||t)).attr("transform","translate("+(c.node(t).x-c.node(t).width/2)+","+(c.node(t).y-c.node(t).height/2)+" )"))})),c.edges().forEach((function(t){void 0!==t&&void 0!==c.edge(t)&&(d.debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(c.edge(t))),l.drawEdge(f,c.edge(t),c.edge(t).relation,n,r))}));const L=f.node().getBBox(),b=L.width+40,y=L.height+40;X(f,y,b,n.useMaxWidth);const x=`${L.x-g} ${L.y-g} ${b} ${y}`;d.debug(`viewBox ${x}`),f.attr("viewBox",x)},B={draw:$},V={parser:W,db:M,renderer:B,styles:H,init:t=>{t.class||(t.class={}),t.class.arrowMarkerAbsolute=t.arrowMarkerAbsolute,M.clear()}};export{V as diagram};