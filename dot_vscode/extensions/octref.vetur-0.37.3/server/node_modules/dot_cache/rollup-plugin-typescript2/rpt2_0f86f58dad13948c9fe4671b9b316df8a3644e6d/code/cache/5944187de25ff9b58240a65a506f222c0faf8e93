{"code":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { kebabCase } from 'lodash';\r\nimport { TagProviderPriority, getSameTagInSet } from './common';\r\n// @ts-ignore\r\nimport elementTags from 'element-helper-json/element-tags.json';\r\n// @ts-ignore\r\nimport elementAttributes from 'element-helper-json/element-attributes.json';\r\n// @ts-ignore\r\nimport onsenTags from 'vue-onsenui-helper-json/vue-onsenui-tags.json';\r\n// @ts-ignore\r\nimport onsenAttributes from 'vue-onsenui-helper-json/vue-onsenui-attributes.json';\r\n// @ts-ignore\r\nimport bootstrapTags from 'bootstrap-vue-helper-json/tags.json';\r\n// @ts-ignore\r\nimport bootstrapAttributes from 'bootstrap-vue-helper-json/attributes.json';\r\n// @ts-ignore\r\nimport gridsomeTags from 'gridsome-helper-json/gridsome-tags.json';\r\n// @ts-ignore\r\nimport gridsomeAttributes from 'gridsome-helper-json/gridsome-attributes.json';\r\nimport { findConfigFile } from '../../../utils/workspace';\r\nexport const elementTagProvider = getExternalTagProvider('element', elementTags, elementAttributes);\r\nexport const onsenTagProvider = getExternalTagProvider('onsen', onsenTags, onsenAttributes);\r\nexport const bootstrapTagProvider = getExternalTagProvider('bootstrap', bootstrapTags, bootstrapAttributes);\r\nexport const gridsomeTagProvider = getExternalTagProvider('gridsome', gridsomeTags, gridsomeAttributes);\r\n/**\r\n * Get tag providers specified in workspace root's packaage.json\r\n */\r\nexport function getWorkspaceTagProvider(packageRoot, rootPkgJson) {\r\n    if (!rootPkgJson.vetur) {\r\n        return null;\r\n    }\r\n    const tagsPath = findConfigFile(packageRoot, rootPkgJson.vetur.tags);\r\n    const attrsPath = findConfigFile(packageRoot, rootPkgJson.vetur.attributes);\r\n    try {\r\n        if (tagsPath && attrsPath) {\r\n            const tagsJson = JSON.parse(fs.readFileSync(tagsPath, 'utf-8'));\r\n            const attrsJson = JSON.parse(fs.readFileSync(attrsPath, 'utf-8'));\r\n            return getExternalTagProvider('__vetur-workspace', tagsJson, attrsJson);\r\n        }\r\n        return null;\r\n    }\r\n    catch (err) {\r\n        console.error(err.stack);\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Get tag providers specified in packaage.json's `vetur` key\r\n */\r\nexport function getDependencyTagProvider(packageRoot, depName, depPkgJson) {\r\n    if (!depPkgJson.vetur) {\r\n        return null;\r\n    }\r\n    try {\r\n        const tagsPath = require.resolve(path.join(depName, depPkgJson.vetur.tags), { paths: [packageRoot] });\r\n        const attrsPath = require.resolve(path.join(depName, depPkgJson.vetur.attributes), {\r\n            paths: [packageRoot]\r\n        });\r\n        const tagsJson = JSON.parse(fs.readFileSync(tagsPath, 'utf-8'));\r\n        const attrsJson = JSON.parse(fs.readFileSync(attrsPath, 'utf-8'));\r\n        return getExternalTagProvider(depName, tagsJson, attrsJson);\r\n    }\r\n    catch (err) {\r\n        console.error(err.stack);\r\n        return null;\r\n    }\r\n}\r\nexport function getExternalTagProvider(id, tags, attributes) {\r\n    function findAttributeDetail(tag, attr) {\r\n        return (attributes[attr] ||\r\n            attributes[`${tag}/${attr}`] ||\r\n            attributes[`${tag.toLowerCase}/${attr}`] ||\r\n            attributes[`${kebabCase(tag)}/${attr}`]);\r\n    }\r\n    return {\r\n        getId: () => id,\r\n        priority: TagProviderPriority.Library,\r\n        collectTags(collector) {\r\n            for (const tagName in tags) {\r\n                collector(tagName, tags[tagName].description || '');\r\n            }\r\n        },\r\n        collectAttributes(tag, collector) {\r\n            var _a;\r\n            const attrs = (_a = getSameTagInSet(tags, tag)) === null || _a === void 0 ? void 0 : _a.attributes;\r\n            if (!attrs) {\r\n                return;\r\n            }\r\n            for (const attr of attrs) {\r\n                const detail = findAttributeDetail(tag, attr);\r\n                if ((detail === null || detail === void 0 ? void 0 : detail.type) === 'boolean') {\r\n                    collector(attr, 'v', (detail && detail.description) || '');\r\n                }\r\n                else if ((detail === null || detail === void 0 ? void 0 : detail.type) === 'event') {\r\n                    collector(attr, 'event', (detail && detail.description) || '');\r\n                }\r\n                else {\r\n                    collector(attr, undefined, (detail && detail.description) || '');\r\n                }\r\n            }\r\n        },\r\n        collectValues(tag, attr, collector) {\r\n            var _a;\r\n            const attrs = (_a = getSameTagInSet(tags, tag)) === null || _a === void 0 ? void 0 : _a.attributes;\r\n            if (!attrs || attrs.indexOf(attr) < 0) {\r\n                return;\r\n            }\r\n            const detail = findAttributeDetail(tag, attr);\r\n            if (!detail || !detail.options) {\r\n                return;\r\n            }\r\n            for (const option of detail.options) {\r\n                collector(option);\r\n            }\r\n        }\r\n    };\r\n}\r\n//# sourceMappingURL=externalTagProviders.js.map","references":["/Users/yoyo930021/git/vetur/server/node_modules/@types/lodash/index.d.ts","/Users/yoyo930021/git/vetur/server/src/modes/template/tagProviders/common.ts","/Users/yoyo930021/git/vetur/server/node_modules/element-helper-json/element-tags.json","/Users/yoyo930021/git/vetur/server/node_modules/element-helper-json/element-attributes.json","/Users/yoyo930021/git/vetur/server/node_modules/vue-onsenui-helper-json/vue-onsenui-tags.json","/Users/yoyo930021/git/vetur/server/node_modules/vue-onsenui-helper-json/vue-onsenui-attributes.json","/Users/yoyo930021/git/vetur/server/node_modules/bootstrap-vue-helper-json/tags.json","/Users/yoyo930021/git/vetur/server/node_modules/bootstrap-vue-helper-json/attributes.json","/Users/yoyo930021/git/vetur/server/node_modules/gridsome-helper-json/gridsome-tags.json","/Users/yoyo930021/git/vetur/server/node_modules/gridsome-helper-json/gridsome-attributes.json","/Users/yoyo930021/git/vetur/server/src/utils/workspace.ts"],"map":"{\"version\":3,\"file\":\"externalTagProviders.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/modes/template/tagProviders/externalTagProviders.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/yoyo930021/git/vetur/server/node_modules/.cache/rollup-plugin-typescript2/placeholder/modes/template/tagProviders/externalTagProviders.d.ts","writeByteOrderMark":false,"text":"import { IHTMLTagProvider } from './common';\r\nexport declare const elementTagProvider: IHTMLTagProvider;\r\nexport declare const onsenTagProvider: IHTMLTagProvider;\r\nexport declare const bootstrapTagProvider: IHTMLTagProvider;\r\nexport declare const gridsomeTagProvider: IHTMLTagProvider;\r\n/**\r\n * Get tag providers specified in workspace root's packaage.json\r\n */\r\nexport declare function getWorkspaceTagProvider(packageRoot: string, rootPkgJson: any): IHTMLTagProvider | null;\r\n/**\r\n * Get tag providers specified in packaage.json's `vetur` key\r\n */\r\nexport declare function getDependencyTagProvider(packageRoot: string, depName: string, depPkgJson: any): IHTMLTagProvider | null;\r\nexport declare function getExternalTagProvider(id: string, tags: any, attributes: any): IHTMLTagProvider;\r\n"}}
