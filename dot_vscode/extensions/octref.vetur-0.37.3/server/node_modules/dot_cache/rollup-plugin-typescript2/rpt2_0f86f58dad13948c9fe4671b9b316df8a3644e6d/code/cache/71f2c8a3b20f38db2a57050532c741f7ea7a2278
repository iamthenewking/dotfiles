{"code":"import path from 'path';\r\nimport { getFileFsPath, getFsPathToUri, getPathDepth, normalizeFileNameToFsPath, normalizeFileNameResolve } from '../utils/paths';\r\nimport { FileChangeType, TextDocumentSyncKind, DocumentFormattingRequest } from 'vscode-languageserver';\r\nimport { CodeActionKind } from 'vscode-languageserver-types';\r\nimport { NULL_COMPLETION, NULL_HOVER, NULL_SIGNATURE } from '../modes/nullMode';\r\nimport { createDependencyService, createNodeModulesPaths } from './dependencyService';\r\nimport _ from 'lodash';\r\nimport { DocumentService } from './documentService';\r\nimport { logger } from '../log';\r\nimport { getDefaultVLSConfig, getVeturFullConfig } from '../config';\r\nimport { VCancellationTokenSource } from '../utils/cancellationToken';\r\nimport { findConfigFile, requireUncached } from '../utils/workspace';\r\nimport { createProjectService } from './projectService';\r\nimport { createEnvironmentService } from './EnvironmentService';\r\nimport { getVueVersionKey, inferVueVersion, VueVersion } from '../utils/vueVersion';\r\nimport { accessSync, constants, existsSync } from 'fs';\r\nimport { sleep } from '../utils/sleep';\r\nimport { URI } from 'vscode-uri';\r\nimport { getSemanticTokenLegends } from '../modes/script/semanticToken';\r\nimport { createRefTokensService } from './RefTokenService';\r\nexport class VLS {\r\n    constructor(lspConnection) {\r\n        this.lspConnection = lspConnection;\r\n        this.pendingValidationRequests = {};\r\n        this.cancellationTokenValidationRequests = {};\r\n        this.validationDelayMs = 200;\r\n        this.documentService = new DocumentService(this.lspConnection);\r\n        this.workspaces = new Map();\r\n        this.projects = new Map();\r\n        this.nodeModulesMap = new Map();\r\n        this.loadingProjects = [];\r\n    }\r\n    async init(params) {\r\n        var _a, _b, _c, _d;\r\n        let rootFsPath = '';\r\n        if (params.rootPath) {\r\n            rootFsPath = normalizeFileNameToFsPath(params.rootPath);\r\n        }\r\n        else if (params.rootUri) {\r\n            rootFsPath = getFileFsPath(params.rootUri);\r\n        }\r\n        const workspaceFolders = Array.isArray(params.workspaceFolders) && ((_a = params.capabilities.workspace) === null || _a === void 0 ? void 0 : _a.workspaceFolders)\r\n            ? params.workspaceFolders.map(el => ({ name: el.name, fsPath: getFileFsPath(el.uri) }))\r\n            : rootFsPath\r\n                ? [{ name: '', fsPath: rootFsPath }]\r\n                : [];\r\n        if (workspaceFolders.length === 0) {\r\n            console.error('No workspace path found. Vetur initialization failed.');\r\n            return {\r\n                capabilities: {}\r\n            };\r\n        }\r\n        this.globalSnippetDir = (_b = params.initializationOptions) === null || _b === void 0 ? void 0 : _b.globalSnippetDir;\r\n        await Promise.all(workspaceFolders.map(workspace => this.addWorkspace(workspace)));\r\n        this.workspaceConfig = this.getVLSFullConfig({}, (_c = params.initializationOptions) === null || _c === void 0 ? void 0 : _c.config);\r\n        if ((_d = params.capabilities.workspace) === null || _d === void 0 ? void 0 : _d.workspaceFolders) {\r\n            this.setupWorkspaceListeners();\r\n        }\r\n        this.setupConfigListeners();\r\n        this.setupLSPHandlers();\r\n        this.setupCustomLSPHandlers();\r\n        this.setupFileChangeListeners();\r\n        this.lspConnection.onShutdown(() => {\r\n            this.dispose();\r\n        });\r\n    }\r\n    listen() {\r\n        this.lspConnection.listen();\r\n    }\r\n    getVLSFullConfig(settings, config) {\r\n        const result = config ? _.merge(getDefaultVLSConfig(), config) : getDefaultVLSConfig();\r\n        Object.keys(settings).forEach(key => {\r\n            _.set(result, key, settings[key]);\r\n        });\r\n        return result;\r\n    }\r\n    async addWorkspace(workspace) {\r\n        // Enable Yarn PnP support https://yarnpkg.com/features/pnp\r\n        if (!process.versions.pnp) {\r\n            if (existsSync(path.join(workspace.fsPath, '.pnp.js'))) {\r\n                require(path.join(workspace.fsPath, '.pnp.js')).setup();\r\n            }\r\n            else if (existsSync(path.join(workspace.fsPath, '.pnp.cjs'))) {\r\n                require(path.join(workspace.fsPath, '.pnp.cjs')).setup();\r\n            }\r\n        }\r\n        let veturConfigPath = findConfigFile(workspace.fsPath, 'vetur.config.js');\r\n        if (!veturConfigPath) {\r\n            veturConfigPath = findConfigFile(workspace.fsPath, 'vetur.config.cjs');\r\n        }\r\n        const rootPathForConfig = normalizeFileNameToFsPath(veturConfigPath ? path.dirname(veturConfigPath) : workspace.fsPath);\r\n        if (!this.workspaces.has(rootPathForConfig)) {\r\n            this.workspaces.set(rootPathForConfig, Object.assign(Object.assign({ name: workspace.name }, (await getVeturFullConfig(rootPathForConfig, workspace.fsPath, veturConfigPath ? requireUncached(veturConfigPath) : {}))), { isExistVeturConfig: !!veturConfigPath, workspaceFsPath: workspace.fsPath }));\r\n        }\r\n    }\r\n    setupWorkspaceListeners() {\r\n        this.lspConnection.onInitialized(() => {\r\n            this.lspConnection.workspace.onDidChangeWorkspaceFolders(async (e) => {\r\n                await Promise.all(e.added.map(el => this.addWorkspace({ name: el.name, fsPath: getFileFsPath(el.uri) })));\r\n            });\r\n        });\r\n    }\r\n    setupConfigListeners() {\r\n        this.lspConnection.onDidChangeConfiguration(async ({ settings }) => {\r\n            var _a, _b, _c, _d, _e, _f;\r\n            this.workspaceConfig = this.getVLSFullConfig({}, settings);\r\n            let isFormatEnable = (_d = (_c = (_b = (_a = this.workspaceConfig) === null || _a === void 0 ? void 0 : _a.vetur) === null || _b === void 0 ? void 0 : _b.format) === null || _c === void 0 ? void 0 : _c.enable) !== null && _d !== void 0 ? _d : false;\r\n            logger.setLevel((_f = (_e = this.workspaceConfig) === null || _e === void 0 ? void 0 : _e.vetur) === null || _f === void 0 ? void 0 : _f.dev.logLevel);\r\n            this.projects.forEach(project => {\r\n                const veturConfig = this.workspaces.get(project.env.getRootPathForConfig());\r\n                if (!veturConfig) {\r\n                    return;\r\n                }\r\n                const fullConfig = this.getVLSFullConfig(veturConfig.settings, this.workspaceConfig);\r\n                project.env.configure(fullConfig);\r\n                isFormatEnable = isFormatEnable || fullConfig.vetur.format.enable;\r\n            });\r\n            this.setupDynamicFormatters(isFormatEnable);\r\n        });\r\n        this.documentService.getAllDocuments().forEach(this.triggerValidation);\r\n    }\r\n    getAllProjectConfigs() {\r\n        return _.flatten(Array.from(this.workspaces.entries()).map(([rootPathForConfig, veturConfig]) => veturConfig.projects.map(project => (Object.assign(Object.assign({}, project), { rootPathForConfig, vlsFullConfig: this.getVLSFullConfig(veturConfig.settings, this.workspaceConfig), workspaceFsPath: veturConfig.workspaceFsPath, isExistVeturConfig: veturConfig.isExistVeturConfig })))))\r\n            .map(project => ({\r\n            vlsFullConfig: project.vlsFullConfig,\r\n            isExistVeturConfig: project.isExistVeturConfig,\r\n            rootPathForConfig: project.rootPathForConfig,\r\n            workspaceFsPath: project.workspaceFsPath,\r\n            rootFsPath: project.root,\r\n            tsconfigPath: project.tsconfig,\r\n            packagePath: project.package,\r\n            snippetFolder: project.snippetFolder,\r\n            globalComponents: project.globalComponents\r\n        }))\r\n            .sort((a, b) => getPathDepth(b.rootFsPath, '/') - getPathDepth(a.rootFsPath, '/'));\r\n    }\r\n    warnProjectIfNeed(projectConfig) {\r\n        var _a;\r\n        if (projectConfig.vlsFullConfig.vetur.ignoreProjectWarning) {\r\n            return;\r\n        }\r\n        const isFileCanAccess = (fsPath) => {\r\n            try {\r\n                accessSync(fsPath, constants.R_OK);\r\n                return true;\r\n            }\r\n            catch (_a) {\r\n                return false;\r\n            }\r\n        };\r\n        const showErrorIfCantAccess = (name, fsPath) => {\r\n            this.lspConnection.window.showErrorMessage(`Vetur can't access ${fsPath} for ${name}.`);\r\n        };\r\n        const showWarningAndLearnMore = (message, url) => {\r\n            this.lspConnection.window.showWarningMessage(message, { title: 'Learn More' }).then(action => {\r\n                if (action) {\r\n                    this.openWebsite(url);\r\n                }\r\n            });\r\n        };\r\n        const getCantFindMessage = (fileNames) => `Vetur can't find ${fileNames.map(el => `\\`${el}\\``).join(' or ')} in ${projectConfig.rootFsPath}.`;\r\n        if (!projectConfig.tsconfigPath) {\r\n            showWarningAndLearnMore(getCantFindMessage(['tsconfig.json', 'jsconfig.json']), 'https://vuejs.github.io/vetur/guide/FAQ.html#vetur-can-t-find-tsconfig-json-jsconfig-json-in-xxxx-xxxxxx');\r\n        }\r\n        else if (!isFileCanAccess(projectConfig.tsconfigPath)) {\r\n            showErrorIfCantAccess('ts/js config', projectConfig.tsconfigPath);\r\n        }\r\n        else {\r\n            if (!projectConfig.isExistVeturConfig &&\r\n                ![\r\n                    normalizeFileNameResolve(projectConfig.rootFsPath, 'tsconfig.json'),\r\n                    normalizeFileNameResolve(projectConfig.rootFsPath, 'jsconfig.json')\r\n                ].includes((_a = projectConfig.tsconfigPath) !== null && _a !== void 0 ? _a : '')) {\r\n                showWarningAndLearnMore(`Vetur found \\`tsconfig.json\\`/\\`jsconfig.json\\`, but they aren\\'t in the project root.`, 'https://vuejs.github.io/vetur/guide/FAQ.html#vetur-found-xxx-but-they-aren-t-in-the-project-root');\r\n            }\r\n        }\r\n        if (!projectConfig.packagePath) {\r\n            showWarningAndLearnMore(getCantFindMessage(['package.json']), 'https://vuejs.github.io/vetur/guide/FAQ.html#vetur-can-t-find-package-json-in-xxxx-xxxxxx');\r\n        }\r\n        else if (!isFileCanAccess(projectConfig.packagePath)) {\r\n            showErrorIfCantAccess('ts/js config', projectConfig.packagePath);\r\n        }\r\n        else {\r\n            if (!projectConfig.isExistVeturConfig &&\r\n                normalizeFileNameResolve(projectConfig.rootFsPath, 'package.json') !== projectConfig.packagePath) {\r\n                showWarningAndLearnMore(`Vetur found \\`package.json\\`/, but it isn\\'t in the project root.`, 'https://vuejs.github.io/vetur/guide/FAQ.html#vetur-found-xxx-but-they-aren-t-in-the-project-root');\r\n            }\r\n            if (inferVueVersion(projectConfig.packagePath) === VueVersion.V30) {\r\n                showWarningAndLearnMore(`In the vue 3 project, The Vue Language Features (Volar) is new recommended extension in VSCode.`, 'https://marketplace.visualstudio.com/items?itemName=Vue.volar');\r\n            }\r\n        }\r\n    }\r\n    getProjectRootPath(uri) {\r\n        var _a;\r\n        return (_a = this.getProjectConfig(uri)) === null || _a === void 0 ? void 0 : _a.rootFsPath;\r\n    }\r\n    getProjectConfig(uri) {\r\n        const projectConfigs = this.getAllProjectConfigs();\r\n        const docFsPath = getFileFsPath(uri);\r\n        const projectConfig = projectConfigs.find(projectConfig => docFsPath.startsWith(projectConfig.rootFsPath) &&\r\n            ['/', '\\\\'].includes(docFsPath.substring(projectConfig.rootFsPath.length, projectConfig.rootFsPath.length + 1)));\r\n        return projectConfig;\r\n    }\r\n    async getProjectService(uri) {\r\n        var _a;\r\n        const projectConfig = this.getProjectConfig(uri);\r\n        if (!projectConfig) {\r\n            return undefined;\r\n        }\r\n        const useWorkspaceDependencies = projectConfig.vlsFullConfig.vetur.useWorkspaceDependencies;\r\n        if (this.projects.has(projectConfig.rootFsPath)) {\r\n            const project = this.projects.get(projectConfig.rootFsPath);\r\n            if ((project === null || project === void 0 ? void 0 : project.env.getConfig().vetur.useWorkspaceDependencies) === useWorkspaceDependencies) {\r\n                return project;\r\n            }\r\n        }\r\n        // Load project once\r\n        if (this.loadingProjects.includes(projectConfig.rootFsPath)) {\r\n            while (!this.projects.has(projectConfig.rootFsPath)) {\r\n                await sleep(500);\r\n            }\r\n            return this.projects.get(projectConfig.rootFsPath);\r\n        }\r\n        // init project\r\n        // Yarn Pnp don't need this. https://yarnpkg.com/features/pnp\r\n        this.loadingProjects.push(projectConfig.rootFsPath);\r\n        const workDoneProgress = await this.lspConnection.window.createWorkDoneProgress();\r\n        workDoneProgress.begin(`Load project: ${projectConfig.rootFsPath}`, undefined);\r\n        const nodeModulePaths = useWorkspaceDependencies\r\n            ? (_a = this.nodeModulesMap.get(projectConfig.rootPathForConfig)) !== null && _a !== void 0 ? _a : createNodeModulesPaths(projectConfig.rootPathForConfig)\r\n            : [];\r\n        if (useWorkspaceDependencies) {\r\n            this.nodeModulesMap.set(projectConfig.rootPathForConfig, nodeModulePaths);\r\n        }\r\n        const dependencyService = await createDependencyService(projectConfig.rootPathForConfig, projectConfig.workspaceFsPath, projectConfig.vlsFullConfig.vetur.useWorkspaceDependencies, nodeModulePaths, projectConfig.vlsFullConfig.typescript.tsdk);\r\n        this.warnProjectIfNeed(projectConfig);\r\n        const project = await createProjectService(createEnvironmentService(projectConfig.rootPathForConfig, projectConfig.rootFsPath, projectConfig.tsconfigPath, projectConfig.packagePath, projectConfig.snippetFolder, projectConfig.globalComponents, projectConfig.vlsFullConfig), this.documentService, this.globalSnippetDir, dependencyService, createRefTokensService(this.lspConnection));\r\n        this.projects.set(projectConfig.rootFsPath, project);\r\n        workDoneProgress.done();\r\n        return project;\r\n    }\r\n    setupLSPHandlers() {\r\n        this.lspConnection.onCompletion(this.onCompletion.bind(this));\r\n        this.lspConnection.onCompletionResolve(this.onCompletionResolve.bind(this));\r\n        this.lspConnection.onDefinition(this.onDefinition.bind(this));\r\n        this.lspConnection.onDocumentFormatting(this.onDocumentFormatting.bind(this));\r\n        this.lspConnection.onDocumentHighlight(this.onDocumentHighlight.bind(this));\r\n        this.lspConnection.onDocumentLinks(this.onDocumentLinks.bind(this));\r\n        this.lspConnection.onDocumentSymbol(this.onDocumentSymbol.bind(this));\r\n        this.lspConnection.onHover(this.onHover.bind(this));\r\n        this.lspConnection.onReferences(this.onReferences.bind(this));\r\n        this.lspConnection.onSignatureHelp(this.onSignatureHelp.bind(this));\r\n        this.lspConnection.onFoldingRanges(this.onFoldingRanges.bind(this));\r\n        this.lspConnection.onCodeAction(this.onCodeAction.bind(this));\r\n        this.lspConnection.onCodeActionResolve(this.onCodeActionResolve.bind(this));\r\n        this.lspConnection.workspace.onWillRenameFiles(this.onWillRenameFiles.bind(this));\r\n        this.lspConnection.languages.semanticTokens.on(this.onSemanticToken.bind(this));\r\n        this.lspConnection.languages.semanticTokens.onRange(this.onSemanticToken.bind(this));\r\n        this.lspConnection.onDocumentColor(this.onDocumentColors.bind(this));\r\n        this.lspConnection.onColorPresentation(this.onColorPresentations.bind(this));\r\n        this.lspConnection.onExecuteCommand(this.executeCommand.bind(this));\r\n    }\r\n    setupCustomLSPHandlers() {\r\n        this.lspConnection.onRequest('$/doctor', async ({ fileName }) => {\r\n            var _a, _b;\r\n            const uri = getFsPathToUri(fileName);\r\n            const projectConfigs = this.getAllProjectConfigs();\r\n            const project = await this.getProjectService(uri);\r\n            return JSON.stringify({\r\n                name: 'Vetur doctor info',\r\n                fileName,\r\n                currentProject: {\r\n                    vueVersion: project ? getVueVersionKey(project === null || project === void 0 ? void 0 : project.env.getVueVersion()) : null,\r\n                    rootPathForConfig: (_a = project === null || project === void 0 ? void 0 : project.env.getRootPathForConfig()) !== null && _a !== void 0 ? _a : null,\r\n                    projectRootFsPath: (_b = project === null || project === void 0 ? void 0 : project.env.getProjectRoot()) !== null && _b !== void 0 ? _b : null\r\n                },\r\n                activeProjects: Array.from(this.projects.keys()),\r\n                projectConfigs\r\n            }, null, 2);\r\n        });\r\n        this.lspConnection.onRequest('$/queryVirtualFileInfo', async ({ fileName, currFileText }) => {\r\n            const project = await this.getProjectService(getFsPathToUri(fileName));\r\n            return (project === null || project === void 0 ? void 0 : project.languageModes.getMode('vue-html')).queryVirtualFileInfo(fileName, currFileText);\r\n        });\r\n        this.lspConnection.onRequest('$/getDiagnostics', async (params) => {\r\n            const doc = this.documentService.getDocument(params.uri);\r\n            if (doc) {\r\n                const diagnostics = await this.doValidate(doc);\r\n                return diagnostics !== null && diagnostics !== void 0 ? diagnostics : [];\r\n            }\r\n            return [];\r\n        });\r\n    }\r\n    async setupDynamicFormatters(enable) {\r\n        if (enable) {\r\n            if (!this.documentFormatterRegistration) {\r\n                this.documentFormatterRegistration = await this.lspConnection.client.register(DocumentFormattingRequest.type, {\r\n                    documentSelector: [{ language: 'vue' }]\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            if (this.documentFormatterRegistration) {\r\n                this.documentFormatterRegistration.dispose();\r\n            }\r\n        }\r\n    }\r\n    setupFileChangeListeners() {\r\n        this.documentService.onDidChangeContent(change => {\r\n            this.triggerValidation(change.document);\r\n        });\r\n        this.documentService.onDidClose(e => {\r\n            this.removeDocument(e.document);\r\n            this.lspConnection.sendDiagnostics({ uri: e.document.uri, diagnostics: [] });\r\n        });\r\n        this.lspConnection.onDidChangeWatchedFiles(({ changes }) => {\r\n            changes.forEach(async (c) => {\r\n                var _a, _b;\r\n                if (c.type === FileChangeType.Changed) {\r\n                    const fsPath = getFileFsPath(c.uri);\r\n                    // when `vetur.config.js` changed\r\n                    if (this.workspaces.has(fsPath)) {\r\n                        logger.logInfo(`refresh vetur config when ${fsPath} changed.`);\r\n                        const name = (_b = (_a = this.workspaces.get(fsPath)) === null || _a === void 0 ? void 0 : _a.name) !== null && _b !== void 0 ? _b : '';\r\n                        this.workspaces.delete(fsPath);\r\n                        await this.addWorkspace({ name, fsPath });\r\n                        this.projects.forEach((project, projectRoot) => {\r\n                            if (project.env.getRootPathForConfig() === fsPath) {\r\n                                project.dispose();\r\n                                this.projects.delete(projectRoot);\r\n                            }\r\n                        });\r\n                        return;\r\n                    }\r\n                    const project = await this.getProjectService(c.uri);\r\n                    project === null || project === void 0 ? void 0 : project.languageModes.getAllModes().forEach(m => {\r\n                        if (m.onDocumentChanged) {\r\n                            m.onDocumentChanged(fsPath);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            this.documentService.getAllDocuments().forEach(d => {\r\n                this.triggerValidation(d);\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Custom Notifications\r\n     */\r\n    openWebsite(url) {\r\n        this.lspConnection.window.showDocument({ uri: URI.parse(url).toString(), external: true });\r\n    }\r\n    /**\r\n     * Language Features\r\n     */\r\n    async onDocumentFormatting(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDocumentFormatting(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onCompletion(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onCompletion(params)) !== null && _a !== void 0 ? _a : NULL_COMPLETION;\r\n    }\r\n    async onCompletionResolve(item) {\r\n        var _a;\r\n        if (!item.data) {\r\n            return item;\r\n        }\r\n        const project = await this.getProjectService(item.data.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onCompletionResolve(item)) !== null && _a !== void 0 ? _a : item;\r\n    }\r\n    async onHover(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onHover(params)) !== null && _a !== void 0 ? _a : NULL_HOVER;\r\n    }\r\n    async onDocumentHighlight(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDocumentHighlight(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onDefinition(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDefinition(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onReferences(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onReferences(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onDocumentLinks(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDocumentLinks(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onDocumentSymbol(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDocumentSymbol(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onDocumentColors(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onDocumentColors(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onColorPresentations(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onColorPresentations(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onSignatureHelp(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onSignatureHelp(params)) !== null && _a !== void 0 ? _a : NULL_SIGNATURE;\r\n    }\r\n    async onFoldingRanges(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onFoldingRanges(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onCodeAction(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onCodeAction(params)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    async onCodeActionResolve(action) {\r\n        var _a, _b;\r\n        if (!action.data) {\r\n            return action;\r\n        }\r\n        const project = await this.getProjectService((_a = action.data) === null || _a === void 0 ? void 0 : _a.uri);\r\n        return (_b = project === null || project === void 0 ? void 0 : project.onCodeActionResolve(action)) !== null && _b !== void 0 ? _b : action;\r\n    }\r\n    async onWillRenameFiles({ files }) {\r\n        const inTheSameProject = files.filter(file => {\r\n            const oldFileProject = this.getProjectRootPath(file.oldUri);\r\n            const newFileProject = this.getProjectRootPath(file.newUri);\r\n            return oldFileProject && newFileProject && oldFileProject === newFileProject;\r\n        });\r\n        const documentChanges = _.flatten(await Promise.all(inTheSameProject.map(async (rename) => {\r\n            var _a;\r\n            const projectService = await this.getProjectService(rename.newUri);\r\n            return (_a = projectService === null || projectService === void 0 ? void 0 : projectService.onWillRenameFile(rename)) !== null && _a !== void 0 ? _a : [];\r\n        })));\r\n        if (!documentChanges.length) {\r\n            return null;\r\n        }\r\n        return {\r\n            documentChanges\r\n        };\r\n    }\r\n    async onSemanticToken(params) {\r\n        var _a;\r\n        const project = await this.getProjectService(params.textDocument.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.onSemanticTokens(params)) !== null && _a !== void 0 ? _a : { data: [] };\r\n    }\r\n    triggerValidation(textDocument) {\r\n        if (textDocument.uri.includes('node_modules')) {\r\n            return;\r\n        }\r\n        this.cleanPendingValidation(textDocument);\r\n        this.cancelPastValidation(textDocument);\r\n        this.pendingValidationRequests[textDocument.uri] = setTimeout(() => {\r\n            delete this.pendingValidationRequests[textDocument.uri];\r\n            this.cancellationTokenValidationRequests[textDocument.uri] = new VCancellationTokenSource();\r\n            this.validateTextDocument(textDocument, this.cancellationTokenValidationRequests[textDocument.uri].token);\r\n        }, this.validationDelayMs);\r\n    }\r\n    cancelPastValidation(textDocument) {\r\n        const source = this.cancellationTokenValidationRequests[textDocument.uri];\r\n        if (source) {\r\n            source.cancel();\r\n            source.dispose();\r\n            delete this.cancellationTokenValidationRequests[textDocument.uri];\r\n        }\r\n    }\r\n    cleanPendingValidation(textDocument) {\r\n        const request = this.pendingValidationRequests[textDocument.uri];\r\n        if (request) {\r\n            clearTimeout(request);\r\n            delete this.pendingValidationRequests[textDocument.uri];\r\n        }\r\n    }\r\n    async validateTextDocument(textDocument, cancellationToken) {\r\n        const diagnostics = await this.doValidate(textDocument, cancellationToken);\r\n        if (diagnostics) {\r\n            this.lspConnection.sendDiagnostics({ uri: textDocument.uri, diagnostics });\r\n        }\r\n    }\r\n    async doValidate(doc, cancellationToken) {\r\n        var _a;\r\n        const project = await this.getProjectService(doc.uri);\r\n        return (_a = project === null || project === void 0 ? void 0 : project.doValidate(doc, cancellationToken)) !== null && _a !== void 0 ? _a : null;\r\n    }\r\n    async executeCommand(arg) {\r\n        logger.logInfo(`Unknown command ${arg.command}.`);\r\n    }\r\n    async removeDocument(doc) {\r\n        const project = await this.getProjectService(doc.uri);\r\n        project === null || project === void 0 ? void 0 : project.languageModes.onDocumentRemoved(doc);\r\n    }\r\n    dispose() {\r\n        this.projects.forEach(project => {\r\n            project.dispose();\r\n        });\r\n    }\r\n    get capabilities() {\r\n        return {\r\n            textDocumentSync: TextDocumentSyncKind.Incremental,\r\n            workspace: {\r\n                workspaceFolders: { supported: true, changeNotifications: true },\r\n                fileOperations: { willRename: { filters: [{ pattern: { glob: '**/*.{ts,js,vue}' } }] } }\r\n            },\r\n            completionProvider: { resolveProvider: true, triggerCharacters: ['.', ':', '<', '\"', \"'\", '/', '@', '*', ' '] },\r\n            signatureHelpProvider: { triggerCharacters: ['('] },\r\n            documentFormattingProvider: false,\r\n            hoverProvider: true,\r\n            documentHighlightProvider: true,\r\n            documentLinkProvider: {\r\n                resolveProvider: false\r\n            },\r\n            documentSymbolProvider: true,\r\n            definitionProvider: true,\r\n            referencesProvider: true,\r\n            codeActionProvider: {\r\n                codeActionKinds: [\r\n                    CodeActionKind.QuickFix,\r\n                    CodeActionKind.Refactor,\r\n                    CodeActionKind.RefactorExtract,\r\n                    CodeActionKind.RefactorInline,\r\n                    CodeActionKind.RefactorRewrite,\r\n                    CodeActionKind.Source,\r\n                    CodeActionKind.SourceOrganizeImports\r\n                ],\r\n                resolveProvider: true\r\n            },\r\n            colorProvider: true,\r\n            executeCommandProvider: {\r\n                commands: []\r\n            },\r\n            foldingRangeProvider: true,\r\n            semanticTokensProvider: {\r\n                range: true,\r\n                full: true,\r\n                legend: getSemanticTokenLegends()\r\n            }\r\n        };\r\n    }\r\n}\r\n//# sourceMappingURL=vls.js.map","references":["/Users/yoyo930021/git/vetur/server/src/utils/paths.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-languageserver/lib/common/api.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-languageserver-types/lib/umd/main.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-languageserver-textdocument/lib/umd/main.d.ts","/Users/yoyo930021/git/vetur/server/src/modes/nullMode.ts","/Users/yoyo930021/git/vetur/server/src/services/dependencyService.ts","/Users/yoyo930021/git/vetur/server/node_modules/@types/lodash/index.d.ts","/Users/yoyo930021/git/vetur/server/src/services/documentService.ts","/Users/yoyo930021/git/vetur/server/src/modes/template/index.ts","/Users/yoyo930021/git/vetur/server/src/log.ts","/Users/yoyo930021/git/vetur/server/src/config.ts","/Users/yoyo930021/git/vetur/server/src/utils/cancellationToken.ts","/Users/yoyo930021/git/vetur/server/src/utils/workspace.ts","/Users/yoyo930021/git/vetur/server/src/services/projectService.ts","/Users/yoyo930021/git/vetur/server/src/services/EnvironmentService.ts","/Users/yoyo930021/git/vetur/server/src/utils/vueVersion.ts","/Users/yoyo930021/git/vetur/server/src/utils/sleep.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-uri/lib/umd/index.d.ts","/Users/yoyo930021/git/vetur/server/src/modes/script/semanticToken.ts","/Users/yoyo930021/git/vetur/server/src/services/RefTokenService.ts"],"map":"{\"version\":3,\"file\":\"vls.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/vls.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/yoyo930021/git/vetur/server/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/vls.d.ts","writeByteOrderMark":false,"text":"import { DocumentColorParams, DocumentFormattingParams, DocumentLinkParams, Connection, TextDocumentPositionParams, ColorPresentationParams, InitializeParams, ServerCapabilities, DocumentSymbolParams, CodeActionParams, CompletionParams, ExecuteCommandParams, FoldingRangeParams, RenameFilesParams, SemanticTokensParams, SemanticTokens, SemanticTokensRangeParams } from 'vscode-languageserver';\r\nimport { ColorInformation, CompletionItem, CompletionList, Definition, DocumentHighlight, DocumentLink, Hover, Location, SignatureHelp, SymbolInformation, TextEdit, ColorPresentation, FoldingRange, DocumentUri, CodeAction } from 'vscode-languageserver-types';\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport { VCancellationToken } from '../utils/cancellationToken';\r\nexport declare class VLS {\r\n    private lspConnection;\r\n    private workspaces;\r\n    private nodeModulesMap;\r\n    private documentService;\r\n    private globalSnippetDir;\r\n    private loadingProjects;\r\n    private projects;\r\n    private pendingValidationRequests;\r\n    private cancellationTokenValidationRequests;\r\n    private validationDelayMs;\r\n    private documentFormatterRegistration;\r\n    private workspaceConfig;\r\n    constructor(lspConnection: Connection);\r\n    init(params: InitializeParams): Promise<{\r\n        capabilities: {};\r\n    } | undefined>;\r\n    listen(): void;\r\n    private getVLSFullConfig;\r\n    private addWorkspace;\r\n    private setupWorkspaceListeners;\r\n    private setupConfigListeners;\r\n    private getAllProjectConfigs;\r\n    private warnProjectIfNeed;\r\n    getProjectRootPath(uri: DocumentUri): string | undefined;\r\n    private getProjectConfig;\r\n    private getProjectService;\r\n    private setupLSPHandlers;\r\n    private setupCustomLSPHandlers;\r\n    private setupDynamicFormatters;\r\n    private setupFileChangeListeners;\r\n    /**\r\n     * Custom Notifications\r\n     */\r\n    openWebsite(url: string): void;\r\n    /**\r\n     * Language Features\r\n     */\r\n    onDocumentFormatting(params: DocumentFormattingParams): Promise<TextEdit[]>;\r\n    onCompletion(params: CompletionParams): Promise<CompletionList>;\r\n    onCompletionResolve(item: CompletionItem): Promise<CompletionItem>;\r\n    onHover(params: TextDocumentPositionParams): Promise<Hover>;\r\n    onDocumentHighlight(params: TextDocumentPositionParams): Promise<DocumentHighlight[]>;\r\n    onDefinition(params: TextDocumentPositionParams): Promise<Definition>;\r\n    onReferences(params: TextDocumentPositionParams): Promise<Location[]>;\r\n    onDocumentLinks(params: DocumentLinkParams): Promise<DocumentLink[]>;\r\n    onDocumentSymbol(params: DocumentSymbolParams): Promise<SymbolInformation[]>;\r\n    onDocumentColors(params: DocumentColorParams): Promise<ColorInformation[]>;\r\n    onColorPresentations(params: ColorPresentationParams): Promise<ColorPresentation[]>;\r\n    onSignatureHelp(params: TextDocumentPositionParams): Promise<SignatureHelp | null>;\r\n    onFoldingRanges(params: FoldingRangeParams): Promise<FoldingRange[]>;\r\n    onCodeAction(params: CodeActionParams): Promise<never[] | CodeAction[]>;\r\n    onCodeActionResolve(action: CodeAction): Promise<CodeAction>;\r\n    onWillRenameFiles({ files }: RenameFilesParams): Promise<{\r\n        documentChanges: import(\"vscode-languageserver-types\").TextDocumentEdit[];\r\n    } | null>;\r\n    onSemanticToken(params: SemanticTokensParams | SemanticTokensRangeParams): Promise<SemanticTokens>;\r\n    private triggerValidation;\r\n    cancelPastValidation(textDocument: TextDocument): void;\r\n    cleanPendingValidation(textDocument: TextDocument): void;\r\n    validateTextDocument(textDocument: TextDocument, cancellationToken?: VCancellationToken): Promise<void>;\r\n    doValidate(doc: TextDocument, cancellationToken?: VCancellationToken): Promise<import(\"vscode-languageserver-types\").Diagnostic[] | null>;\r\n    executeCommand(arg: ExecuteCommandParams): Promise<void>;\r\n    removeDocument(doc: TextDocument): Promise<void>;\r\n    dispose(): void;\r\n    get capabilities(): ServerCapabilities;\r\n}\r\n"}}
