{"code":"import path from 'path';\r\nimport { parse } from 'vue-eslint-parser';\r\nimport { URI } from 'vscode-uri';\r\nimport { getVueDocumentRegions } from '../../embeddedSupport/embeddedSupport';\r\nimport { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport { getTemplateTransformFunctions, componentHelperName, iterationHelperName, renderHelperName, componentDataName } from './transformTemplate';\r\nimport { templateSourceMap } from './serviceHost';\r\nimport { generateSourceMap } from './sourceMap';\r\nimport { isVirtualVueTemplateFile, isVueFile } from './util';\r\nimport { kebabCase, snakeCase } from 'lodash';\r\nconst importedComponentName = '__vlsComponent';\r\nexport function parseVueScript(text) {\r\n    const doc = TextDocument.create('test://test/test.vue', 'vue', 0, text);\r\n    const regions = getVueDocumentRegions(doc);\r\n    const script = regions.getSingleTypeDocument('script');\r\n    return script.getText();\r\n}\r\nfunction parseVueScriptSrc(text) {\r\n    const doc = TextDocument.create('test://test/test.vue', 'vue', 0, text);\r\n    const regions = getVueDocumentRegions(doc);\r\n    return regions.getImportedScripts()[0];\r\n}\r\nexport function parseVueTemplate(text) {\r\n    const doc = TextDocument.create('test://test/test.vue', 'vue', 0, text);\r\n    const regions = getVueDocumentRegions(doc);\r\n    const template = regions.getSingleTypeDocument('template');\r\n    if (template.languageId !== 'vue-html') {\r\n        return '';\r\n    }\r\n    const rawText = template.getText();\r\n    // skip checking on empty template\r\n    if (rawText.replace(/\\s/g, '') === '') {\r\n        return '';\r\n    }\r\n    return rawText.replace(/ {10}/, '<template>') + '</template>';\r\n}\r\nexport function createUpdater(tsModule, allChildComponentsInfo) {\r\n    const clssf = tsModule.createLanguageServiceSourceFile;\r\n    const ulssf = tsModule.updateLanguageServiceSourceFile;\r\n    const scriptKindTracker = new WeakMap();\r\n    const modificationTracker = new WeakSet();\r\n    const printer = tsModule.createPrinter();\r\n    function modifySourceFile(fileName, sourceFile, scriptSnapshot, version, scriptKind) {\r\n        if (modificationTracker.has(sourceFile)) {\r\n            return;\r\n        }\r\n        if (isVueFile(fileName)) {\r\n            modifyVueScript(tsModule, sourceFile);\r\n            modificationTracker.add(sourceFile);\r\n            return;\r\n        }\r\n    }\r\n    /**\r\n     * The transformed TS AST has synthetic nodes so language features would fail on them\r\n     * Use printer to print the AST as re-parse the source to get a valid SourceFile\r\n     */\r\n    function recreateVueTemplateSourceFile(vueTemplateFileName, sourceFile, scriptSnapshot) {\r\n        var _a;\r\n        // TODO: share the logic of transforming the code into AST\r\n        // with the template mode\r\n        const vueText = scriptSnapshot.getText(0, scriptSnapshot.getLength());\r\n        const templateCode = parseVueTemplate(vueText);\r\n        const scriptSrc = parseVueScriptSrc(vueText);\r\n        const program = parse(templateCode, { sourceType: 'module' });\r\n        const childComponentNames = (_a = allChildComponentsInfo.get(vueTemplateFileName)) === null || _a === void 0 ? void 0 : _a.map(c => snakeCase(c.name));\r\n        let expressions = [];\r\n        try {\r\n            expressions = getTemplateTransformFunctions(tsModule, childComponentNames).transformTemplate(program, templateCode);\r\n            injectVueTemplate(tsModule, sourceFile, expressions, scriptSrc);\r\n        }\r\n        catch (err) {\r\n            console.log(`Failed to transform template of ${vueTemplateFileName}`);\r\n            console.error(err.stack);\r\n        }\r\n        let newText = printer.printFile(sourceFile);\r\n        if (allChildComponentsInfo.has(vueTemplateFileName)) {\r\n            const childComponents = allChildComponentsInfo.get(vueTemplateFileName);\r\n            newText += convertChildComponentsInfoToSource(childComponents);\r\n        }\r\n        const newSourceFile = tsModule.createSourceFile(vueTemplateFileName, newText, sourceFile.languageVersion, true /* setParentNodes: Need this to walk the AST */, tsModule.ScriptKind.TS);\r\n        // Assign version to the new template sourceFile to avoid re-processing\r\n        // *internal* property\r\n        newSourceFile.version = sourceFile.version;\r\n        newSourceFile.scriptSnapshot = {\r\n            getText: (start, end) => newText.substring(start, end),\r\n            getLength: () => newText.length,\r\n            getChangeRange: () => void 0\r\n        };\r\n        const templateFsPath = URI.file(vueTemplateFileName).fsPath;\r\n        const sourceMapNodes = generateSourceMap(tsModule, sourceFile, newSourceFile);\r\n        templateSourceMap[templateFsPath] = sourceMapNodes;\r\n        templateSourceMap[templateFsPath.slice(0, -'.template'.length)] = sourceMapNodes;\r\n        return newSourceFile;\r\n    }\r\n    function createLanguageServiceSourceFile(fileName, scriptSnapshot, scriptTarget, version, setNodeParents, scriptKind) {\r\n        let sourceFile = clssf(fileName, scriptSnapshot, scriptTarget, version, setNodeParents, scriptKind);\r\n        scriptKindTracker.set(sourceFile, scriptKind);\r\n        if (isVirtualVueTemplateFile(fileName)) {\r\n            sourceFile = recreateVueTemplateSourceFile(fileName, sourceFile, scriptSnapshot);\r\n            modificationTracker.add(sourceFile);\r\n        }\r\n        else {\r\n            modifySourceFile(fileName, sourceFile, scriptSnapshot, version, scriptKind);\r\n        }\r\n        return sourceFile;\r\n    }\r\n    function updateLanguageServiceSourceFile(sourceFile, scriptSnapshot, version, textChangeRange, aggressiveChecks) {\r\n        const scriptKind = scriptKindTracker.get(sourceFile);\r\n        sourceFile = ulssf(sourceFile, scriptSnapshot, version, textChangeRange, aggressiveChecks);\r\n        if (isVirtualVueTemplateFile(sourceFile.fileName)) {\r\n            sourceFile = recreateVueTemplateSourceFile(sourceFile.fileName, sourceFile, scriptSnapshot);\r\n            modificationTracker.add(sourceFile);\r\n        }\r\n        else {\r\n            modifySourceFile(sourceFile.fileName, sourceFile, scriptSnapshot, version, scriptKind);\r\n        }\r\n        return sourceFile;\r\n    }\r\n    return {\r\n        createLanguageServiceSourceFile,\r\n        updateLanguageServiceSourceFile\r\n    };\r\n}\r\nfunction modifyVueScript(tsModule, sourceFile) {\r\n    const exportDefaultObject = sourceFile.statements.find(st => st.kind === tsModule.SyntaxKind.ExportAssignment &&\r\n        st.expression.kind === tsModule.SyntaxKind.ObjectLiteralExpression);\r\n    if (exportDefaultObject) {\r\n        // 1. add `import Vue from 'vue'\r\n        // (the span of the inserted statement must be (0,0) to avoid overlapping existing statements)\r\n        const setZeroPos = getWrapperRangeSetter(tsModule, { pos: 0, end: 0 });\r\n        const vueImport = setZeroPos(createImportDeclaration(tsModule, undefined, undefined, setZeroPos(tsModule.createImportClause(tsModule.createIdentifier('__vueEditorBridge'), undefined)), setZeroPos(tsModule.createLiteral('vue-editor-bridge'))));\r\n        const statements = sourceFile.statements;\r\n        statements.unshift(vueImport);\r\n        // 2. find the export default and wrap it in `__vueEditorBridge(...)` if it exists and is an object literal\r\n        // (the span of the function construct call and *all* its members must be the same as the object literal it wraps)\r\n        const objectLiteral = exportDefaultObject.expression;\r\n        const setObjPos = getWrapperRangeSetter(tsModule, objectLiteral);\r\n        const vue = tsModule.setTextRange(tsModule.createIdentifier('__vueEditorBridge'), {\r\n            pos: objectLiteral.pos,\r\n            end: objectLiteral.pos + 1\r\n        });\r\n        exportDefaultObject.expression = setObjPos(tsModule.createCall(vue, undefined, [objectLiteral]));\r\n        setObjPos(exportDefaultObject.expression.arguments);\r\n    }\r\n    else {\r\n        // @ts-expect-error\r\n        sourceFile.externalModuleIndicator = createExportAssignment(tsModule, undefined, undefined, tsModule.createCall(tsModule.createIdentifier('__vueEditorBridge'), undefined, [tsModule.createObjectLiteral([])]));\r\n    }\r\n}\r\n/**\r\n * Wrap render function with component options in the script block\r\n * to validate its types\r\n */\r\nexport function injectVueTemplate(tsModule, sourceFile, renderBlock, scriptSrc) {\r\n    // add import statement for corresponding Vue file\r\n    // so that we acquire the component type from it.\r\n    let componentFilePath;\r\n    if (scriptSrc) {\r\n        // When script block refers external file (<script src=\"./MyComp.ts\"></script>).\r\n        // We need to strip `.ts` suffix to avoid a compilation error.\r\n        componentFilePath = scriptSrc.replace(/\\.ts$/, '');\r\n    }\r\n    else {\r\n        // Importing original `.vue` file will get component type when the script is written by inline.\r\n        componentFilePath = './' + path.basename(sourceFile.fileName.slice(0, -'.template'.length));\r\n    }\r\n    const componentImport = createImportDeclaration(tsModule, undefined, undefined, tsModule.createImportClause(tsModule.createIdentifier(importedComponentName), undefined), tsModule.createLiteral(componentFilePath));\r\n    const createImportSpecifier = (name) => {\r\n        const [major, minor] = tsModule.version.split('.');\r\n        if ((Number(major) === 4 && Number(minor) >= 5) || Number(major) > 4) {\r\n            return tsModule.createImportSpecifier(false, undefined, tsModule.createIdentifier(name));\r\n        }\r\n        // @ts-expect-error\r\n        return tsModule.createImportSpecifier(undefined, tsModule.createIdentifier(name));\r\n    };\r\n    // import helper type to handle Vue's private methods\r\n    const helperImport = createImportDeclaration(tsModule, undefined, undefined, tsModule.createImportClause(undefined, tsModule.createNamedImports([\r\n        createImportSpecifier(renderHelperName),\r\n        createImportSpecifier(componentHelperName),\r\n        createImportSpecifier(iterationHelperName),\r\n        createImportSpecifier(componentDataName)\r\n    ])), tsModule.createLiteral('vue-editor-bridge'));\r\n    // wrap render code with a function decralation\r\n    // with `this` type of component.\r\n    const statements = renderBlock.map(exp => tsModule.createExpressionStatement(exp));\r\n    const renderElement = tsModule.createExpressionStatement(tsModule.createCall(tsModule.createIdentifier(renderHelperName), undefined, [\r\n        // Reference to the component\r\n        tsModule.createIdentifier(importedComponentName),\r\n        // A function simulating the render function\r\n        tsModule.createFunctionExpression(undefined, undefined, undefined, undefined, [], undefined, tsModule.createBlock(statements))\r\n    ]));\r\n    // replace the original statements with wrapped code.\r\n    sourceFile.statements = tsModule.createNodeArray([componentImport, helperImport, renderElement]);\r\n    // Update external module indicator to the transformed template node,\r\n    // otherwise symbols in this template (e.g. __Component) will be put\r\n    // into global namespace and it causes duplicated identifier error.\r\n    sourceFile.externalModuleIndicator = componentImport;\r\n}\r\nfunction createImportDeclaration(tsModule, decorators, modifiers, importClause, moduleSpecifier) {\r\n    const [major, minor] = tsModule.version.split('.');\r\n    if ((Number(major) === 4 && Number(minor) >= 8) || Number(major) > 4) {\r\n        return tsModule.factory.createImportDeclaration(decorators, modifiers, importClause, moduleSpecifier);\r\n    }\r\n    return tsModule.createImportDeclaration(decorators, modifiers, importClause, moduleSpecifier);\r\n}\r\nfunction createExportAssignment(tsModule, modifiers, isExportEquals, expression) {\r\n    const [major, minor] = tsModule.version.split('.');\r\n    if ((Number(major) === 4 && Number(minor) >= 8) || Number(major) > 4) {\r\n        return tsModule.factory.createExportAssignment(modifiers, isExportEquals, expression);\r\n    }\r\n    // @ts-expect-error\r\n    return tsModule.createExportAssignment(modifiers, isExportEquals, undefined, expression);\r\n}\r\n/** Create a function that calls setTextRange on synthetic wrapper nodes that need a valid range */\r\nfunction getWrapperRangeSetter(tsModule, wrapped) {\r\n    return wrapperNode => tsModule.setTextRange(wrapperNode, wrapped);\r\n}\r\nfunction convertChildComponentsInfoToSource(childComponents) {\r\n    let src = '';\r\n    childComponents.forEach(c => {\r\n        var _a, _b, _c, _d;\r\n        const componentDataInterfaceName = componentDataName + '__' + snakeCase(c.name);\r\n        const componentHelperInterfaceName = componentHelperName + '__' + snakeCase(c.name);\r\n        const propTypeStrings = [];\r\n        (_b = (_a = c.info) === null || _a === void 0 ? void 0 : _a.componentInfo.props) === null || _b === void 0 ? void 0 : _b.forEach(p => {\r\n            let typeKey = kebabCase(p.name);\r\n            if (typeKey.includes('-')) {\r\n                typeKey = `'` + typeKey + `'`;\r\n            }\r\n            if (!p.required) {\r\n                typeKey += '?';\r\n            }\r\n            if (p.typeString) {\r\n                propTypeStrings.push(`${typeKey}: ${p.typeString}`);\r\n            }\r\n            else {\r\n                propTypeStrings.push(`${typeKey}: any`);\r\n            }\r\n        });\r\n        propTypeStrings.push('[other: string]: any');\r\n        const onTypeStrings = [];\r\n        (_d = (_c = c.info) === null || _c === void 0 ? void 0 : _c.componentInfo.emits) === null || _d === void 0 ? void 0 : _d.forEach(e => {\r\n            let typeKey = kebabCase(e.name);\r\n            if (typeKey.includes('-')) {\r\n                typeKey = `'` + typeKey + `'`;\r\n            }\r\n            typeKey += '?';\r\n            if (e.typeString) {\r\n                onTypeStrings.push(`${typeKey}: ($event: any) => (${e.typeString})`);\r\n            }\r\n            else {\r\n                onTypeStrings.push(`${typeKey}: ($event: any) => any`);\r\n            }\r\n        });\r\n        src += `\ninterface ${componentDataInterfaceName}<T, TH> extends ${componentDataName}<T, TH> {\n  props: { ${propTypeStrings.join(', ')} }\n  on: { ${onTypeStrings.join(', ')} } & { [K in keyof T]?: (this: TH, $event: T[K]) => any; }\n}\ndeclare const ${componentHelperInterfaceName}: {\n  <T>(\n    vm: T,\n    tag: string,\n    data: ${componentDataInterfaceName}<Record<string, any>, T> & ThisType<T>,\n    children: any[]\n  ): any\n}`;\r\n    });\r\n    return src;\r\n}\r\n//# sourceMappingURL=preprocess.js.map","references":["/Users/yoyo930021/git/vetur/server/node_modules/typescript/lib/typescript.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/vue-eslint-parser/index.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-uri/lib/umd/index.d.ts","/Users/yoyo930021/git/vetur/server/src/embeddedSupport/embeddedSupport.ts","/Users/yoyo930021/git/vetur/server/node_modules/vscode-languageserver-textdocument/lib/umd/main.d.ts","/Users/yoyo930021/git/vetur/server/src/services/typescriptService/transformTemplate.ts","/Users/yoyo930021/git/vetur/server/src/services/typescriptService/serviceHost.ts","/Users/yoyo930021/git/vetur/server/src/services/typescriptService/sourceMap.ts","/Users/yoyo930021/git/vetur/server/src/services/typescriptService/util.ts","/Users/yoyo930021/git/vetur/server/src/services/vueInfoService.ts","/Users/yoyo930021/git/vetur/server/node_modules/@types/lodash/index.d.ts","/Users/yoyo930021/git/vetur/server/src/services/dependencyService.ts"],"map":"{\"version\":3,\"file\":\"preprocess.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/typescriptService/preprocess.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/yoyo930021/git/vetur/server/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/typescriptService/preprocess.d.ts","writeByteOrderMark":false,"text":"import type ts from 'typescript';\r\nimport { ChildComponent } from '../vueInfoService';\r\nimport { RuntimeLibrary } from '../dependencyService';\r\nexport declare function parseVueScript(text: string): string;\r\nexport declare function parseVueTemplate(text: string): string;\r\nexport declare function createUpdater(tsModule: RuntimeLibrary['typescript'], allChildComponentsInfo: Map<string, ChildComponent[]>): {\r\n    createLanguageServiceSourceFile: (fileName: string, scriptSnapshot: ts.IScriptSnapshot, scriptTarget: ts.ScriptTarget, version: string, setNodeParents: boolean, scriptKind?: ts.ScriptKind) => ts.SourceFile;\r\n    updateLanguageServiceSourceFile: (sourceFile: ts.SourceFile, scriptSnapshot: ts.IScriptSnapshot, version: string, textChangeRange: ts.TextChangeRange, aggressiveChecks?: boolean) => ts.SourceFile;\r\n};\r\n/**\r\n * Wrap render function with component options in the script block\r\n * to validate its types\r\n */\r\nexport declare function injectVueTemplate(tsModule: RuntimeLibrary['typescript'], sourceFile: ts.SourceFile, renderBlock: ts.Expression[], scriptSrc?: string): void;\r\n"}}
