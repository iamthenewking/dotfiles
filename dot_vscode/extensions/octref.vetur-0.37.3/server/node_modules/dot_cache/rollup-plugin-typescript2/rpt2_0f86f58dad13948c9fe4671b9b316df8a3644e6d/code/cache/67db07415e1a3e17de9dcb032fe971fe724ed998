{"code":"import path from 'path';\r\nimport fg from 'fast-glob';\r\nimport fs from 'fs';\r\nimport util from 'util';\r\nimport { performance } from 'perf_hooks';\r\nimport { logger } from '../log';\r\nimport { getPathDepth } from '../utils/paths';\r\n// dependencies\r\nimport ts from 'typescript';\r\nimport prettier from 'prettier';\r\nimport prettyHTML from '@starptech/prettyhtml';\r\nimport prettierEslint from 'prettier-eslint';\r\nimport * as prettierTslint from 'prettier-tslint';\r\nimport stylusSupremacy from 'stylus-supremacy';\r\nimport * as prettierPluginPug from '@prettier/plugin-pug';\r\nconst readFileAsync = util.promisify(fs.readFile);\r\nconst accessFileAsync = util.promisify(fs.access);\r\nexport function createNodeModulesPaths(rootPath) {\r\n    if (process.versions.pnp) {\r\n        return [];\r\n    }\r\n    const startTime = performance.now();\r\n    const nodeModules = fg.sync('**/node_modules', {\r\n        cwd: rootPath.replace(/\\\\/g, '/'),\r\n        absolute: true,\r\n        unique: true,\r\n        onlyFiles: false,\r\n        onlyDirectories: true,\r\n        suppressErrors: true,\r\n        deep: 6,\r\n        followSymbolicLinks: true,\r\n        ignore: ['**/node_modules/**/node_modules']\r\n    });\r\n    logger.logInfo(`Find node_modules paths in ${rootPath} - ${Math.round(performance.now() - startTime)}ms`);\r\n    return nodeModules;\r\n}\r\nasync function findAllPackages(nodeModulesPaths, moduleName) {\r\n    async function getPackage(nodeModulesPath) {\r\n        const packageJSONPath = path.resolve(nodeModulesPath, moduleName, 'package.json');\r\n        try {\r\n            await accessFileAsync(packageJSONPath, fs.constants.R_OK);\r\n            const info = JSON.parse(await readFileAsync(packageJSONPath, { encoding: 'utf8' }));\r\n            return {\r\n                name: info.name,\r\n                dir: path.dirname(packageJSONPath),\r\n                version: info.version,\r\n                module: require(path.resolve(path.dirname(packageJSONPath), info.main))\r\n            };\r\n        }\r\n        catch (_a) {\r\n            return null;\r\n        }\r\n    }\r\n    const packages = (await Promise.all(nodeModulesPaths.map(path => getPackage(path)))).filter(info => info);\r\n    return packages;\r\n}\r\nfunction compareDependency(a, b) {\r\n    const aDepth = getPathDepth(a.dir, path.sep);\r\n    const bDepth = getPathDepth(b.dir, path.sep);\r\n    return bDepth - aDepth;\r\n}\r\nconst bundledModules = {\r\n    typescript: ts,\r\n    prettier,\r\n    '@starptech/prettyhtml': prettyHTML,\r\n    'prettier-eslint': prettierEslint,\r\n    'prettier-tslint': prettierTslint,\r\n    'stylus-supremacy': stylusSupremacy,\r\n    '@prettier/plugin-pug': prettierPluginPug\r\n};\r\nexport const createDependencyService = async (rootPathForConfig, workspacePath, useWorkspaceDependencies, nodeModulesPaths, tsSDKPath) => {\r\n    let loaded;\r\n    const loadTsSDKPath = () => {\r\n        if (!tsSDKPath) {\r\n            throw new Error('No tsSDKPath in settings');\r\n        }\r\n        const dir = path.isAbsolute(tsSDKPath)\r\n            ? path.resolve(tsSDKPath, '..')\r\n            : path.resolve(workspacePath, tsSDKPath, '..');\r\n        const tsModule = require(dir);\r\n        logger.logInfo(`Loaded typescript@${tsModule.version} from ${dir} for tsdk.`);\r\n        return {\r\n            dir,\r\n            version: tsModule.version,\r\n            bundled: false,\r\n            module: tsModule\r\n        };\r\n    };\r\n    const loadTypeScript = async () => {\r\n        try {\r\n            if (useWorkspaceDependencies && tsSDKPath) {\r\n                return [loadTsSDKPath()];\r\n            }\r\n            if (useWorkspaceDependencies) {\r\n                const packages = await findAllPackages(nodeModulesPaths, 'typescript');\r\n                if (packages.length === 0) {\r\n                    throw new Error(`No find any packages in ${rootPathForConfig}.`);\r\n                }\r\n                return packages\r\n                    .map(pkg => {\r\n                    logger.logInfo(`Loaded typescript@${pkg.version} from ${pkg.dir}.`);\r\n                    return {\r\n                        dir: pkg.dir,\r\n                        version: pkg.version,\r\n                        bundled: false,\r\n                        module: pkg.module\r\n                    };\r\n                })\r\n                    .sort(compareDependency);\r\n            }\r\n            throw new Error('No useWorkspaceDependencies.');\r\n        }\r\n        catch (e) {\r\n            logger.logDebug(e.message);\r\n            logger.logInfo(`Loaded bundled typescript@${ts.version}.`);\r\n            return [\r\n                {\r\n                    dir: '',\r\n                    version: ts.version,\r\n                    bundled: true,\r\n                    module: ts\r\n                }\r\n            ];\r\n        }\r\n    };\r\n    const loadCommonDep = async (name, bundleModule) => {\r\n        try {\r\n            if (useWorkspaceDependencies) {\r\n                const packages = await findAllPackages(nodeModulesPaths, name);\r\n                if (packages.length === 0) {\r\n                    throw new Error(`No find ${name} packages in ${rootPathForConfig}.`);\r\n                }\r\n                return packages\r\n                    .map(pkg => {\r\n                    logger.logInfo(`Loaded ${name}@${pkg.version} from ${pkg.dir}.`);\r\n                    return {\r\n                        dir: pkg.dir,\r\n                        version: pkg.version,\r\n                        bundled: false,\r\n                        module: pkg.module\r\n                    };\r\n                })\r\n                    .sort(compareDependency);\r\n            }\r\n            throw new Error('No useWorkspaceDependencies.');\r\n        }\r\n        catch (e) {\r\n            logger.logDebug(e.message);\r\n            // TODO: Get bundle package version\r\n            logger.logInfo(`Loaded bundled ${name}.`);\r\n            return [\r\n                {\r\n                    dir: '',\r\n                    version: '',\r\n                    bundled: true,\r\n                    module: bundleModule\r\n                }\r\n            ];\r\n        }\r\n    };\r\n    if (!process.versions.pnp) {\r\n        loaded = {\r\n            typescript: await loadTypeScript(),\r\n            prettier: await loadCommonDep('prettier', bundledModules['prettier']),\r\n            '@starptech/prettyhtml': await loadCommonDep('@starptech/prettyhtml', bundledModules['@starptech/prettyhtml']),\r\n            'prettier-eslint': await loadCommonDep('prettier-eslint', bundledModules['prettier-eslint']),\r\n            'prettier-tslint': await loadCommonDep('prettier-tslint', bundledModules['prettier-tslint']),\r\n            'stylus-supremacy': await loadCommonDep('stylus-supremacy', bundledModules['stylus-supremacy']),\r\n            '@prettier/plugin-pug': await loadCommonDep('@prettier/plugin-pug', bundledModules['@prettier/plugin-pug'])\r\n        };\r\n    }\r\n    const get = (lib, filePath) => {\r\n        // We find it when yarn pnp. https://yarnpkg.com/features/pnp\r\n        if (process.versions.pnp) {\r\n            if (!useWorkspaceDependencies) {\r\n                return getBundled(lib);\r\n            }\r\n            if (useWorkspaceDependencies && tsSDKPath && lib === 'typescript') {\r\n                return loadTsSDKPath();\r\n            }\r\n            const pkgPath = require.resolve(lib, { paths: [filePath !== null && filePath !== void 0 ? filePath : workspacePath] });\r\n            return {\r\n                dir: path.dirname(pkgPath),\r\n                version: '',\r\n                bundled: false,\r\n                module: require(pkgPath)\r\n            };\r\n        }\r\n        if (!loaded) {\r\n            throw new Error('Please call init function before get dependency.');\r\n        }\r\n        const deps = loaded[lib];\r\n        // When no filePath, read root workspace dep\r\n        if (!filePath) {\r\n            return deps[deps.length - 1];\r\n        }\r\n        // When only one dep, return it\r\n        if (deps.length === 1) {\r\n            return deps[0];\r\n        }\r\n        const possiblePaths = [];\r\n        let tempPath = path.dirname(filePath);\r\n        while (rootPathForConfig === tempPath ||\r\n            getPathDepth(rootPathForConfig, path.sep) < getPathDepth(tempPath, path.sep)) {\r\n            possiblePaths.push(path.resolve(tempPath, `node_modules/${lib}`));\r\n            tempPath = path.resolve(tempPath, '../');\r\n        }\r\n        const result = deps.find(dep => possiblePaths.includes(dep.dir));\r\n        return result !== null && result !== void 0 ? result : deps[0];\r\n    };\r\n    const getBundled = (lib) => {\r\n        return {\r\n            dir: '',\r\n            version: '',\r\n            bundled: true,\r\n            module: bundledModules[lib]\r\n        };\r\n    };\r\n    return {\r\n        useWorkspaceDependencies,\r\n        nodeModulesPaths,\r\n        get,\r\n        getBundled\r\n    };\r\n};\r\n//# sourceMappingURL=dependencyService.js.map","references":["/Users/yoyo930021/git/vetur/server/node_modules/fast-glob/out/index.d.ts","/Users/yoyo930021/git/vetur/server/src/log.ts","/Users/yoyo930021/git/vetur/server/src/utils/paths.ts","/Users/yoyo930021/git/vetur/server/node_modules/typescript/lib/typescript.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/@types/prettier/index.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/@starptech/prettyhtml/index.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/prettier-eslint/types/index.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/prettier-tslint/dist/index.js","/Users/yoyo930021/git/vetur/server/node_modules/stylus-supremacy/edge/index.d.ts","/Users/yoyo930021/git/vetur/server/node_modules/@prettier/plugin-pug/dist/index.js"],"map":"{\"version\":3,\"file\":\"dependencyService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/dependencyService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/yoyo930021/git/vetur/server/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/dependencyService.d.ts","writeByteOrderMark":false,"text":"import ts from 'typescript';\r\nimport prettier from 'prettier';\r\nimport prettyHTML from '@starptech/prettyhtml';\r\nimport prettierEslint from 'prettier-eslint';\r\nimport * as prettierTslint from 'prettier-tslint';\r\nimport stylusSupremacy from 'stylus-supremacy';\r\nimport * as prettierPluginPug from '@prettier/plugin-pug';\r\nexport declare function createNodeModulesPaths(rootPath: string): string[];\r\ninterface Dependency<M> {\r\n    dir: string;\r\n    version: string;\r\n    bundled: boolean;\r\n    module: M;\r\n}\r\nexport interface RuntimeLibrary {\r\n    typescript: typeof ts;\r\n    prettier: typeof prettier;\r\n    '@starptech/prettyhtml': typeof prettyHTML;\r\n    'prettier-eslint': typeof prettierEslint;\r\n    'prettier-tslint': typeof prettierTslint;\r\n    'stylus-supremacy': typeof stylusSupremacy;\r\n    '@prettier/plugin-pug': typeof prettierPluginPug;\r\n}\r\nexport interface DependencyService {\r\n    readonly useWorkspaceDependencies: boolean;\r\n    readonly nodeModulesPaths: string[];\r\n    get<L extends keyof RuntimeLibrary>(lib: L, filePath?: string): Dependency<RuntimeLibrary[L]>;\r\n    getBundled<L extends keyof RuntimeLibrary>(lib: L): Dependency<RuntimeLibrary[L]>;\r\n}\r\nexport declare const createDependencyService: (rootPathForConfig: string, workspacePath: string, useWorkspaceDependencies: boolean, nodeModulesPaths: string[], tsSDKPath?: string) => Promise<DependencyService>;\r\nexport {};\r\n"}}
